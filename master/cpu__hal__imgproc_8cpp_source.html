<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ECVL: cpu_hal_imgproc.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
          fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
          forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
          forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
          vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
          vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
          hdotsfor: ["\\dots", 1],
          mathbbm: ["\\mathbb{#1}", 1],
          bordermatrix: ["\\matrix{#1}", 1]
      }
  }
}
);
//]]>
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js" type="text/javascript"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" type="image/png" href="DEEPHEALTH_favicon.png"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DEEPHEALTH_doxygen_logo_reduced.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div><!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e05d7e2b1ecd646af5bb94391405f3b5.html">modules</a></li><li class="navelem"><a class="el" href="dir_6d4da112a1331882b0b6514a341190a0.html">core</a></li><li class="navelem"><a class="el" href="dir_23a40276a19143fa3e703d4deb108ec1.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cpu_hal_imgproc.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cpu__hal__imgproc_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">* ECVL - European Computer Vision Library</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">* Version: 0.2.1</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">* copyright (c) 2020, Università degli Studi di Modena e Reggio Emilia (UNIMORE), AImageLab</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">* Authors:</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">*    Costantino Grana (costantino.grana@unimore.it)</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*    Federico Bolelli (federico.bolelli@unimore.it)</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*    Michele Cancilla (michele.cancilla@unimore.it)</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*    Laura Canalini (laura.canalini@unimore.it)</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*    Stefano Allegretti (stefano.allegretti@unimore.it)</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">* All rights reserved.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cpu__hal_8h.html">ecvl/core/cpu_hal.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;opencv2/photo.hpp&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;opencv2/calib3d.hpp&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="imgproc_8h.html">ecvl/core/imgproc.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="arithmetic_8h.html">ecvl/core/arithmetic.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="support__opencv_8h.html">ecvl/core/support_opencv.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using namespace </span>std;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceecvl.html">ecvl</a></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespaceecvl.html#ad058d736c33b57b2ac70e690ba642739">   28</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ad058d736c33b57b2ac70e690ba642739">RGB2GRAYGeneric</a>(<span class="keyword">const</span> uint8_t* r, <span class="keyword">const</span> uint8_t* g, <span class="keyword">const</span> uint8_t* b, uint8_t* dst, <a class="code" href="namespaceecvl.html#aaf30aceb57f44dc62f5f666f3955d857">DataType</a> dt)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// 0.299 * R + 0.587 * G + 0.114 * B</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#define DEREF(ptr, type)            *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(ptr)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#define CONST_DEREF(ptr, type)      *reinterpret_cast&lt;const TypeInfo_t&lt;DataType::type&gt;*&gt;(ptr)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">case DataType::type: DEREF(dst, type) = saturate_cast&lt;DataType::type&gt;(0.299 * CONST_DEREF(r, type) + 0.587 * CONST_DEREF(g, type) + 0.114 * CONST_DEREF(b, type));  break;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">switch</span> (dt) {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#undef DEREF</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#undef CONST_DEREF</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">   47</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; src)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (!(src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>() &amp;&amp; src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>() &amp;&amp; src.<a class="code" href="classecvl_1_1_image.html#a7b6db514661e150f16a534abe577c859">Channels</a>() &amp;&amp; <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>) == 3 &amp;&amp; src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> != DataType::int64)) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a9e3e4d82efc8d2b049d07f21bd3182ab">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a010dd55cace0a7b700391238952f9e55">CpuHal::ResizeDim</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; dst, <span class="keyword">const</span> std::vector&lt;int&gt;&amp; newdims, <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    cv::Mat m;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    cv::resize(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), m, cv::Size(newdims[0], newdims[1]), 0.0, 0.0, <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">ecvl::MatToImage</a>(m);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a9ed1dbe0fba639daf886071876c94a8a">   63</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ad1c7691a1077870fe935da837a3759f6">CpuHal::ResizeScale</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; scales, <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">int</span> nw = lround(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] * scales[0]);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">int</span> nh = lround(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] * scales[1]);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    cv::Mat m;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    cv::resize(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), m, cv::Size(nw, nh), 0.0, 0.0, <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp));</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">ecvl::MatToImage</a>(m);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a2098159b81f5528c57f5ab43c77de8d2">   75</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a518c444d5c0b3697fc248ef964094f51">CpuHal::Flip2D</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; dst)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">size_t</span> c_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;c&#39;</span>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">size_t</span> x_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;x&#39;</span>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">size_t</span> y_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;y&#39;</span>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (c_pos == string::npos || x_pos == string::npos || y_pos == string::npos) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="standard__errors_8h.html#a7b2b9053b329e941dcc0a8c14017b9bb">ECVL_ERROR_WRONG_PARAMS</a>(<span class="stringliteral">&quot;Malformed src image&quot;</span>)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">int</span> src_width = src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">int</span> src_height = src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">int</span> src_channels = src.<a class="code" href="classecvl_1_1_image.html#a7b6db514661e150f16a534abe577c859">Channels</a>();</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">int</span> src_stride_c = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span> src_stride_x = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[x_pos];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">int</span> src_stride_y = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[y_pos];</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    vector&lt;uint8_t*&gt; src_vch(src_channels), tmp_vch(src_channels);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Get the pointers to channels starting pixels</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; src_channels; ++i) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        src_vch[i] = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + i * src_stride_c;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        tmp_vch[i] = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + i * src_stride_c;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> pivot = (src_height + 1) / 2;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0, r_end = src_height - 1; r &lt; pivot; ++r, --r_end) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// Get the address of next row</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">int</span> r1 = r * src_stride_y;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">int</span> r2 = r_end * src_stride_y;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src_width; ++c) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="comment">// Get the address of pixels in current row</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordtype">int</span> p1 = r1 + src_stride_x * c;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordtype">int</span> p2 = r2 + src_stride_x * c;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">        case DataType::type: \</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">            for (int ch = 0; ch &lt; src_channels; ++ch) { \</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">                *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p1) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch] + p2); \</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">                *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p2) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch] + p1); \</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">            } \</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">            break;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">switch</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a132a2ce8d6f307a0a0e9b8702a955be8">  130</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a616ea6f429139cd593198b7804a2a5fd">CpuHal::Mirror2D</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; dst)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">size_t</span> c_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;c&#39;</span>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">size_t</span> x_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;x&#39;</span>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">size_t</span> y_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;y&#39;</span>);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (c_pos == string::npos || x_pos == string::npos || y_pos == string::npos) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="standard__errors_8h.html#a7b2b9053b329e941dcc0a8c14017b9bb">ECVL_ERROR_WRONG_PARAMS</a>(<span class="stringliteral">&quot;Malformed src image&quot;</span>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span> src_width = src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">int</span> src_height = src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">int</span> src_channels = src.<a class="code" href="classecvl_1_1_image.html#a7b6db514661e150f16a534abe577c859">Channels</a>();</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">int</span> src_stride_c = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> src_stride_x = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[x_pos];</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">int</span> src_stride_y = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[y_pos];</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    vector&lt;uint8_t*&gt; src_vch(src_channels), tmp_vch(src_channels);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// Get the pointers to channels starting pixels</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; src_channels; ++i) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        src_vch[i] = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + i * src_stride_c;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        tmp_vch[i] = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + i * src_stride_c;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> pivot = (src_width + 1) / 2;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src_height; ++r) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// Get the address of next row</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">int</span> pos = r * src_stride_y;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0, c_end = src_width - 1; c &lt; pivot; ++c, --c_end) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">// Get the address of pixels in current row</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordtype">int</span> p1 = pos + src_stride_x * c;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordtype">int</span> p2 = pos + src_stride_x * c_end;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">        case DataType::type: \</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">            for (int ch = 0; ch &lt; src_channels; ++ch) { \</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">                *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p1) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch] + p2); \</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">                *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p2) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch] + p1); \</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">            } \</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">            break;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">switch</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#aff4129c4479c898a4da2242baf35521e">  183</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a8a3cab18a350386b58603f465537c379">CpuHal::Rotate2D</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; dst, <span class="keywordtype">double</span> angle, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; center, <span class="keywordtype">double</span> scale, <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    cv::Point2f pt;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (center.empty()) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        pt = { src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] / 2.0f, src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] / 2.0f };</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        pt = { float(center[0]), float(center[1]) };</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    cv::Mat rot_matrix;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    rot_matrix = cv::getRotationMatrix2D(pt, -angle, scale);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    cv::Mat m;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    cv::warpAffine(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), m, rot_matrix, { src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0], src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] }, <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp));</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">ecvl::MatToImage</a>(m);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a7dba06cf872333495baf00cc8ec483b7">  202</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#abfe1f778b26877b429ce72d3bd387a2e">CpuHal::RotateFullImage2D</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">ecvl::Image</a>&amp; dst, <span class="keywordtype">double</span> angle, <span class="keywordtype">double</span> scale, <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    cv::Point2f pt;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    pt = { src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] / 2.0f, src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] / 2.0f };</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    cv::Mat1d rot_matrix;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    rot_matrix = cv::getRotationMatrix2D(pt, -angle, scale);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">int</span> w = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">int</span> h = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">double</span> cos = abs(rot_matrix(0, 0));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">double</span> sin = abs(rot_matrix(0, 1));</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">int</span> nw = lround((h * sin) + (w * cos));</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> nh = lround((h * cos) + (w * sin));</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    rot_matrix(0, 2) += (nw / 2) - pt.x;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    rot_matrix(1, 2) += (nh / 2) - pt.y;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    cv::Mat m;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    cv::warpAffine(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), m, rot_matrix, { nw, nh }, <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">ecvl::MatToImage</a>(m);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a5d24f40e3d4d0c177a6bfe5787db336c">  229</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a93b998f334d8d58ade52f8c2f7655609">CpuHal::ChangeColorSpace</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <a class="code" href="namespaceecvl.html#a0bc0e1d73dcaf4593255a0c9d9325cb3">ColorType</a> new_type)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::HSV || new_type == ColorType::HSV</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        ||</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::YCbCr || new_type == ColorType::YCbCr</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        ||</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::RGBA || new_type == ColorType::RGBA</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        ) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::GRAY) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span> (new_type == ColorType::RGB || new_type == ColorType::BGR) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a> == <span class="stringliteral">&quot;xyc&quot;</span>) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keyword">auto</span> dims = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                dims[2] = 3;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                tmp.<a class="code" href="classecvl_1_1_image.html#a07c762fff510ff3f7b3e267f72131ac3">Create</a>(dims, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, <span class="stringliteral">&quot;xyc&quot;</span>, new_type, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keyword">auto</span> plane0 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 0 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2];</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keyword">auto</span> plane1 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 1 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2];</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keyword">auto</span> plane2 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 2 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2];</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a709cf6785d9340859f9e8dba1f950f7a">contiguous_</a>) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    memcpy(plane0, src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, src.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    memcpy(plane1, src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, src.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    memcpy(plane2, src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, src.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    <span class="keyword">auto</span> i = src.<a class="code" href="classecvl_1_1_image.html#a1d589431ff9de24429b9595386a836dc">Begin</a>&lt;uint8_t&gt;(), e = src.<a class="code" href="classecvl_1_1_image.html#a3f51763dfef4581639a1c9691e072e05">End</a>&lt;uint8_t&gt;();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    <span class="keywordflow">for</span> (; i != e; ++i) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        memcpy(plane0, i.ptr_, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        memcpy(plane1, i.ptr_, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        memcpy(plane2, i.ptr_, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        plane0 += src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                        plane1 += src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        plane2 += src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a> == <span class="stringliteral">&quot;cxy&quot;</span>) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keyword">auto</span> dims = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                dims[0] = 3;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                tmp.<a class="code" href="classecvl_1_1_image.html#a07c762fff510ff3f7b3e267f72131ac3">Create</a>(dims, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, <span class="stringliteral">&quot;cxy&quot;</span>, new_type, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keyword">auto</span> plane0 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 0 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[0];</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keyword">auto</span> plane1 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 1 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[0];</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keyword">auto</span> plane2 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 2 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[0];</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keyword">auto</span> i = src.<a class="code" href="classecvl_1_1_image.html#a1d589431ff9de24429b9595386a836dc">Begin</a>&lt;uint8_t&gt;(), e = src.<a class="code" href="classecvl_1_1_image.html#a3f51763dfef4581639a1c9691e072e05">End</a>&lt;uint8_t&gt;();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keywordflow">for</span> (; i != e; ++i) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    memcpy(plane0, i.ptr_, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    memcpy(plane1, i.ptr_, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    memcpy(plane2, i.ptr_, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    plane0 += 3 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    plane1 += 3 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    plane2 += 3 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        dst = std::move(tmp);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> ((src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::RGB || src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::BGR) &amp;&amp; new_type == ColorType::GRAY) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordtype">size_t</span> c_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;c&#39;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> (c_pos == std::string::npos) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <a class="code" href="standard__errors_8h.html#a7b2b9053b329e941dcc0a8c14017b9bb">ECVL_ERROR_WRONG_PARAMS</a>(<span class="stringliteral">&quot;Malformed src image&quot;</span>)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        std::vector&lt;int&gt; tmp_dims = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        tmp_dims[c_pos] = 1;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        tmp.<a class="code" href="classecvl_1_1_image.html#a07c762fff510ff3f7b3e267f72131ac3">Create</a>(tmp_dims, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, ColorType::GRAY, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keyword">const</span> uint8_t* r = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + ((src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::RGB) ? 0 : 2) * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keyword">const</span> uint8_t* g = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 1 * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keyword">const</span> uint8_t* b = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + ((src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::RGB) ? 2 : 0) * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tmp_pos = 0; tmp_pos &lt; tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>; tmp_pos += tmp.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordtype">int</span> x = static_cast&lt;int&gt;(tmp_pos);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordtype">int</span> src_pos = 0;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>) - 1; i &gt;= 0; i--) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <span class="keywordflow">if</span> (i != c_pos) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    src_pos += (x / tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[i]) * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[i];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    x %= tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[i];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <a class="code" href="namespaceecvl.html#ad058d736c33b57b2ac70e690ba642739">RGB2GRAYGeneric</a>(r + src_pos, g + src_pos, b + src_pos, tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + tmp_pos, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        dst = std::move(tmp);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">//TODO: update with the operator+ for iterators</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::BGR &amp;&amp; new_type == ColorType::RGB</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        ||</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> == ColorType::RGB &amp;&amp; new_type == ColorType::BGR) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a> == <span class="stringliteral">&quot;xyc&quot;</span>) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            tmp.<a class="code" href="classecvl_1_1_image.html#a07c762fff510ff3f7b3e267f72131ac3">Create</a>(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, <span class="stringliteral">&quot;xyc&quot;</span>, new_type, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keyword">auto</span> plane0 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 0 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2];</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keyword">auto</span> plane1 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 1 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2];</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keyword">auto</span> plane2 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 2 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2];</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a709cf6785d9340859f9e8dba1f950f7a">contiguous_</a>) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                memcpy(plane0, src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 2 * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2], src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2]);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                memcpy(plane1, src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 1 * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2], src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2]);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                memcpy(plane2, src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 0 * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2], src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2]);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <a class="code" href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a> == <span class="stringliteral">&quot;cxy&quot;</span>) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            tmp.<a class="code" href="classecvl_1_1_image.html#a07c762fff510ff3f7b3e267f72131ac3">Create</a>(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, <span class="stringliteral">&quot;cxy&quot;</span>, new_type, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keyword">auto</span> plane0 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 0 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[0];</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keyword">auto</span> plane1 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 1 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[0];</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keyword">auto</span> plane2 = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + 2 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[0];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keyword">auto</span> i = src.<a class="code" href="classecvl_1_1_image.html#a1d589431ff9de24429b9595386a836dc">Begin</a>&lt;uint8_t&gt;(), e = src.<a class="code" href="classecvl_1_1_image.html#a3f51763dfef4581639a1c9691e072e05">End</a>&lt;uint8_t&gt;();</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">for</span> (; i != e; ++i) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                memcpy(plane0, i.ptr_ + 2 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                memcpy(plane1, i.ptr_ + 1 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                memcpy(plane2, i.ptr_ + 0 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>, src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                plane0 += 3 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                plane1 += 3 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                plane2 += 3 * src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                ++i; ++i;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <a class="code" href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        dst = std::move(tmp);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="standard__errors_8h.html#af98ae9eed5602ee7ec8cf11ebd970816">ECVL_ERROR_NOT_REACHABLE_CODE</a></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="namespaceecvl.html#a21b3629467ff82c5e3240e353beaad04">  369</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a21b3629467ff82c5e3240e353beaad04">ThresholdImpl</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> thresh, <span class="keywordtype">double</span> maxval, <a class="code" href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92e">ThresholdingType</a> thresh_type)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keyword">auto</span> thresh_t = saturate_cast&lt;T&gt;(thresh);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">auto</span> maxval_t = saturate_cast&lt;T&gt;(maxval);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">auto</span> minval_t = static_cast&lt;T&gt;(0);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    T* src_data = reinterpret_cast&lt;T*&gt;(src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    T* tmp_data = reinterpret_cast&lt;T*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">auto</span> elemsize = src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">switch</span> (thresh_type) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92ea98ad0e8750ae10ad556ed7a62affb452">ecvl::ThresholdingType::BINARY</a>:</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>; i += elemsize) {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            *tmp_data = *src_data &gt; thresh_t ? maxval_t : minval_t;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            ++src_data;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            ++tmp_data;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92ea603de175b826a787a2d96b421089e16e">ecvl::ThresholdingType::BINARY_INV</a>:</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>; i += elemsize) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            *tmp_data = *src_data &lt;= thresh_t ? maxval_t : minval_t;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            ++src_data;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            ++tmp_data;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#af053aebb0952798123a8b5e27299c607">  399</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a41dc0a70968cd6341a85615737ba87a1">CpuHal::Threshold</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> thresh, <span class="keywordtype">double</span> maxval, <a class="code" href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92e">ThresholdingType</a> thresh_type)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">case DataType::type: ThresholdImpl&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(src, dst, thresh, maxval, thresh_type); break;</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">switch</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#aabcbce1e86816d3429eb4e5c8680d3a6">  411</a></span>&#160;std::vector&lt;double&gt; <a class="code" href="namespaceecvl.html#a1222d5cc5852781f9cbe9ef651854f96">CpuHal::Histogram</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    std::vector&lt;double&gt; hist(256, 0);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="classecvl_1_1_const_view.html">ConstView&lt;DataType::uint8&gt;</a> view(src);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = view.<a class="code" href="classecvl_1_1_const_view.html#a03e918dcbad84ebed57b54e3fc0b54ee">Begin</a>(); it != view.<a class="code" href="classecvl_1_1_const_view.html#a931150d6555286759de15cff396d2fad">End</a>(); ++it) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        hist[*it]++;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">int</span> total_pixels = std::accumulate(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>.begin(), src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>.end(), 1, std::multiplies&lt;int&gt;());</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = hist.begin(); it &lt; hist.end(); it++) {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        *it /= total_pixels;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span> hist;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a8a962810c0592d108c5b564d32353115">  428</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceecvl.html#ae40603a556ee0f3dca6b1c32a9e4eae9">CpuHal::OtsuThreshold</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;{</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    std::vector&lt;double&gt; hist = <a class="code" href="namespaceecvl.html#a1222d5cc5852781f9cbe9ef651854f96">Histogram</a>(src);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">double</span> mu_t = 0;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; hist.size(); i++) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        mu_t += hist[i] * i;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">double</span> w_k = 0;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordtype">double</span> mu_k = 0;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">double</span> sigma_max = 0;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">int</span> threshold = 0;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">int</span> hsize = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(hist);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; hsize - 1; k++) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        w_k += hist[k];</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        mu_k += hist[k] * k;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordtype">double</span> sigma = ((mu_t * w_k - mu_k) * (mu_t * w_k - mu_k)) / (w_k * (1 - w_k));</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> (sigma &gt; sigma_max) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            sigma_max = sigma;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            threshold = k;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> threshold;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a0f083e1f8caf9aed50659cdf77956826">  456</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a409958191f9b8fd26b570fef59c7ef72">CpuHal::Filter2D</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; ker, <a class="code" href="namespaceecvl.html#aaf30aceb57f44dc62f5f666f3955d857">DataType</a> type)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, type, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">int</span> hlf_width = ker.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] / 2;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">int</span> hlf_height = ker.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] / 2;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::float64&gt;</a>* ker_data = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::float64&gt;</a>*<span class="keyword">&gt;</span>(ker.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    uint8_t* tmp_ptr = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">//auto tmp_it = tmp.ContiguousBegin&lt;TypeInfo_t&lt;DataType::uint8&gt;&gt;();</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">//auto tmp_it_end = tmp.ContiguousEnd&lt;TypeInfo_t&lt;DataType::uint8&gt;&gt;();</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::uint8&gt;</a>* src_data = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::uint8&gt;</a>*<span class="keyword">&gt;</span>(src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> chan = 0; chan &lt; tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[2]; chan++) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; r++) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; c++) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordtype">double</span> acc = 0;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rk = 0; rk &lt; ker.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; rk++) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ck = 0; ck &lt; ker.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; ck++) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        <span class="keywordtype">int</span> x = c + ck - hlf_width;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        <span class="keywordflow">if</span> (x &lt; 0) x = 0; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt;= tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]) x = tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] - 1;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        <span class="keywordtype">int</span> y = r + rk - hlf_height;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        <span class="keywordflow">if</span> (y &lt; 0) y = 0; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y &gt;= tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]) y = tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] - 1;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        acc += ker_data[i] * src_data[x + y * src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1]];</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        i++;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_ptr) = static_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(acc); break;</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                tmp_ptr += tmp.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        src_data += src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2] / <span class="keyword">sizeof</span>(*src_data);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#ac86d8d62db899460c0c0eed50f760016">  508</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a19e7c44332430068d3aba9677a09446b">CpuHal::SeparableFilter2D</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keyword">const</span> vector&lt;double&gt;&amp; kerX, <span class="keyword">const</span> vector&lt;double&gt;&amp; kerY, <a class="code" href="namespaceecvl.html#aaf30aceb57f44dc62f5f666f3955d857">DataType</a> type)</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp1(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, DataType::float64, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp2(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, type, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">int</span> hlf_width = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(kerX) / 2;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">int</span> hlf_height = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(kerY) / 2;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// X direction</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">auto</span> tmp1_it = tmp1.<a class="code" href="classecvl_1_1_image.html#a1780d0fc6a41ed47a76d2789ca2b0841">ContiguousBegin</a>&lt;<a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::float64&gt;</a>&gt;();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">case DataType::type: \</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">    { \</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">        TypeInfo_t&lt;DataType::type&gt;* src_data = reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src.data_); \</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">        for (int chan = 0; chan &lt; tmp1.dims_[2]; chan++) { \</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">            for (int r = 0; r &lt; tmp1.dims_[1]; r++) { \</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">                for (int c = 0; c &lt; tmp1.dims_[0]; c++) { \</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">                    double acc = 0; \</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">                    for (unsigned int ck = 0; ck &lt; kerX.size(); ck++) { \</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">                        int x = c + ck - hlf_width; \</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">                        if (x &lt; 0) x = 0; else if (x &gt;= tmp1.dims_[0]) x = tmp1.dims_[0] - 1; \</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">                        acc += kerX[ck] * src_data[x]; \</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">                    } \</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">                *tmp1_it = acc; \</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">                ++tmp1_it; \</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">                } \</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">                src_data += src.strides_[1] / sizeof(*src_data); \</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">            } \</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">        } \</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">    } \</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">    break;</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    uint8_t* tmp2_ptr = tmp2.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// Y direction</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::float64&gt;</a>* tmp1_data = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespaceecvl.html#a3300301af431df44980395b301ac4190">TypeInfo_t&lt;DataType::float64&gt;</a>*<span class="keyword">&gt;</span>(tmp1.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> chan = 0; chan &lt; tmp2.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[2]; chan++) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; tmp2.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; r++) {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; tmp2.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; c++) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                <span class="keywordtype">double</span> acc = 0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rk = 0; rk &lt; kerY.size(); rk++) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <span class="keywordtype">int</span> y = r + rk - hlf_height;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <span class="keywordflow">if</span> (y &lt; 0) y = 0; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y &gt;= tmp2.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]) y = tmp2.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] - 1;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    acc += kerY[rk] * tmp1_data[c + y * tmp1.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1] / <span class="keyword">sizeof</span>(*tmp1_data)];</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp2_ptr) = static_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(acc); break;</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                tmp2_ptr += tmp2.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        tmp1_data += tmp1.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2] / <span class="keyword">sizeof</span>(*tmp1_data);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    dst = std::move(tmp2);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#afd50ff378233554fbbb27fdb542b5c80">  578</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ae723594306a62266207448cf9277687a">CpuHal::GaussianBlur</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">int</span> sizeX, <span class="keywordtype">int</span> sizeY, <span class="keywordtype">double</span> sigmaX, <span class="keywordtype">double</span> sigmaY)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;{</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// Find x kernel values</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    vector&lt;double&gt; kernelX(sizeX);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">double</span> sum = 0;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sizeX; i++) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordtype">double</span> coeff = exp(-((i - (sizeX - 1) / 2) * (i - (sizeX - 1) / 2)) / (2 * sigmaX * sigmaX));</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        sum += coeff;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        kernelX[i] = coeff;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sizeX; i++) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        kernelX[i] /= sum;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// Find y kernel values</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    vector&lt;double&gt; kernelY(sizeY);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    sum = 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sizeY; i++) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordtype">double</span> coeff = exp(-((i - (sizeY - 1) / 2) * (i - (sizeY - 1) / 2)) / (2 * sigmaY * sigmaY));</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        sum += coeff;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        kernelY[i] = coeff;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sizeY; i++) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        kernelY[i] /= sum;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="namespaceecvl.html#a19e7c44332430068d3aba9677a09446b">ecvl::SeparableFilter2D</a>(src, dst, kernelX, kernelY);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#af0d7bd7a3db395b4b254b75ded4ac76a">  607</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a5f6d520e7726efcb41a38a9ffd0f4a97">CpuHal::AdditiveLaplaceNoise</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> std_dev)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;{</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    random_device rd;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    mt19937 gen(rd());</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    exponential_distribution&lt;&gt; dist(1 / std_dev);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">for</span> (uint8_t* tmp_ptr = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, *src_ptr = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>; tmp_ptr &lt; tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>; tmp_ptr += tmp.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>, src_ptr += src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordtype">double</span> exp1 = dist(gen);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordtype">double</span> exp2 = dist(gen);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordtype">double</span> noise = exp1 - exp2;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_ptr) = saturate_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(noise + *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_ptr)); break;</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">switch</span> (tmp.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;}</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a9e1bd9f9adac361c9d48f61004042a99">  633</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#aeda12761dec92bd6362480d15c173487">CpuHal::AdditivePoissonNoise</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> lambda)</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;{</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    random_device rd;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    mt19937 gen(rd());</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    poisson_distribution&lt;&gt; dist(lambda);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">for</span> (uint8_t* tmp_ptr = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, *src_ptr = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>; tmp_ptr &lt; tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>; tmp_ptr += tmp.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>, src_ptr += src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordtype">double</span> noise = dist(gen);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_ptr) = saturate_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(noise + *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_ptr)); break;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">switch</span> (tmp.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a2487d7778f9de12c9b198dda3c9aa83b">  656</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ac8a3ad3fc46ff27075d4b671cc996b6c">CpuHal::GammaContrast</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> gamma)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;{</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">for</span> (uint8_t* tmp_ptr = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, *src_ptr = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>; tmp_ptr &lt; tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>; tmp_ptr += tmp.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>, src_ptr += src.<a class="code" href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">elemsize_</a>) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_ptr) = saturate_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(pow(*reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_ptr) / 255., gamma) * 255); break;</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">switch</span> (tmp.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;}</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a08544bdc3a347c97bf3418d62ed23b39">  673</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#abf7537b0520ba88dd624839bc7a951dd">CpuHal::CoarseDropout</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> p, <span class="keywordtype">double</span> drop_size, <span class="keywordtype">bool</span> per_channel)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;{</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp = src;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">int</span> rectX = static_cast&lt;int&gt;(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] * drop_size);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordtype">int</span> rectY = static_cast&lt;int&gt;(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] * drop_size);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (rectX == 0) {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        ++rectX;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">if</span> (rectY == 0) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        ++rectY;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    random_device rd;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    mt19937 gen(rd());</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    discrete_distribution&lt;&gt; dist({ p, 1 - p });</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (per_channel) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[2]; ch++) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            uint8_t* tmp_ptr = tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, 0, ch });</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; r += rectY) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; c += rectX) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    <span class="keywordflow">if</span> (dist(gen) == 0) {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rdrop = r; rdrop &lt; r + rectY &amp;&amp; rdrop &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; rdrop++) {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cdrop = c; cdrop &lt; c + rectX &amp;&amp; cdrop &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; cdrop++) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_ptr + rdrop * tmp.strides_[1] + cdrop * tmp.strides_[0]) = static_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(0); break;</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                <span class="keywordflow">switch</span> (tmp.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                            }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                        }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        vector&lt;uint8_t*&gt; channel_ptrs;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; tmp.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[2]; ch++) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            channel_ptrs.push_back(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, 0, ch }));</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; r += rectY) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; c += rectX) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keywordflow">if</span> (dist(gen) == 0) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[2]; ch++) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rdrop = r; rdrop &lt; r + rectY &amp;&amp; rdrop &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1]; rdrop++) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cdrop = c; cdrop &lt; c + rectX &amp;&amp; cdrop &lt; src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0]; cdrop++) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">case DataType::type: *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(channel_ptrs[ch] + rdrop * tmp.strides_[1] + cdrop * tmp.strides_[0]) = static_cast&lt;TypeInfo_t&lt;DataType::type&gt;&gt;(0); break;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                <span class="keywordflow">switch</span> (tmp.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                            }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        }</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;}</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#aa89ef138d04faf140e5cd9f563a10a9b">  745</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#abd1bed8d85c640bf76e16d28884b1715">CpuHal::IntegralImage</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <a class="code" href="namespaceecvl.html#aaf30aceb57f44dc62f5f666f3955d857">DataType</a> dst_type)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;{</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp({ src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0] + 1, src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1] + 1, src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[2] }, dst_type, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, ColorType::GRAY, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="classecvl_1_1_const_contiguous_view_x_y_c.html">ConstContiguousViewXYC&lt;DataType::uint8&gt;</a> vsrc(src);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="classecvl_1_1_contiguous_view_x_y_c.html">ContiguousViewXYC&lt;DataType::float64&gt;</a> vtmp(tmp);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">switch</span> (tmp.elemtype_) {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">case</span> DataType::float64:</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; vtmp.<a class="code" href="classecvl_1_1_contiguous_view_x_y_c.html#a0ad28b86332b6b381b9ac438dc11432f">height</a>(); ++y) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; vtmp.<a class="code" href="classecvl_1_1_contiguous_view_x_y_c.html#a25ade471367003bedb8cf4507069815f">width</a>(); ++x) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">if</span> (!x || !y) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    vtmp(x, y, 0) = 0.;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    vtmp(x, y, 0) = vsrc(x - 1, y - 1, 0) + vtmp(x - 1, y, 0) + vtmp(x, y - 1, 0) - vtmp(x - 1, y - 1, 0);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;}</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a960b50fa9e414b054313f89dce244939">  769</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ab74faee8c2b550b7bee1fe07e0791c80">CpuHal::NonMaximaSuppression</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst)</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;{</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp = src;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    memset(tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a>, 0, tmp.<a class="code" href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">datasize_</a>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="classecvl_1_1_const_contiguous_view_x_y_c.html">ConstContiguousViewXYC&lt;DataType::int32&gt;</a> vsrc(src);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="classecvl_1_1_contiguous_view_x_y_c.html">ContiguousViewXYC&lt;DataType::int32&gt;</a> vtmp(tmp);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 1; y &lt; vtmp.<a class="code" href="classecvl_1_1_contiguous_view_x_y_c.html#a0ad28b86332b6b381b9ac438dc11432f">height</a>() - 1; ++y) {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 1; x &lt; vtmp.<a class="code" href="classecvl_1_1_contiguous_view_x_y_c.html#a25ade471367003bedb8cf4507069815f">width</a>() - 1; ++x) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordtype">int</span> cur = vsrc(x, y, 0);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">if</span> (cur &lt; vsrc(x - 1, y - 1, 0) ||</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                cur &lt; vsrc(x - 1, y, 0) ||</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                cur &lt; vsrc(x - 1, y + 1, 0) ||</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                cur &lt; vsrc(x, y - 1, 0) ||</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                cur &lt; vsrc(x, y + 1, 0) ||</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                cur &lt; vsrc(x + 1, y - 1, 0) ||</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                cur &lt; vsrc(x + 1, y, 0) ||</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                cur &lt; vsrc(x + 1, y + 1, 0)) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            vtmp(x, y, 0) = cur;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;}</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a36409d0da554359c939879753a2aff2a">  796</a></span>&#160;vector&lt;ecvl::Point2i&gt; <a class="code" href="namespaceecvl.html#a00244523d7d67f01f86034f9358db690">CpuHal::GetMaxN</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <span class="keywordtype">size_t</span> n)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;{</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="classecvl_1_1_const_contiguous_view_x_y_c.html">ConstContiguousViewXYC&lt;DataType::int32&gt;</a> vsrc(src);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keyword">using</span> pqt = pair&lt;int32_t, Point2i&gt;;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    vector&lt;pqt&gt; pq(n, make_pair(std::numeric_limits&lt;int32_t&gt;::min(), <a class="code" href="namespaceecvl.html#ac60a2f087e03fdac8ad7969eaf351616">Point2i</a>{ -1,-1 }));</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; vsrc.<a class="code" href="classecvl_1_1_const_contiguous_view_x_y_c.html#ab470b8de72bdc6126660f0ce18d90c08">height</a>(); ++y) { <span class="comment">// rows</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; vsrc.<a class="code" href="classecvl_1_1_const_contiguous_view_x_y_c.html#a297480632d68860db6e01053eeba94d8">width</a>(); ++x) { <span class="comment">// cols</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            int32_t cur_value = vsrc(x, y, 0);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="keywordflow">if</span> (cur_value &gt; pq.front().first) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                pop_heap(begin(pq), end(pq), greater&lt;pqt&gt;{});</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                pq.back() = make_pair(cur_value, <a class="code" href="namespaceecvl.html#ac60a2f087e03fdac8ad7969eaf351616">Point2i</a>{ x,y });</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                push_heap(begin(pq), end(pq), greater&lt;pqt&gt;{});</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    vector&lt;ecvl::Point2i&gt; max_coords;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    max_coords.reserve(n);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; x : pq) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        max_coords.push_back(x.second);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> max_coords;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">// Union-Find (UF) with path compression (PC) as in:</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">// Two Strategies to Speed up Connected Component Labeling Algorithms</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">// Kesheng Wu, Ekow Otoo, Kenji Suzuki</span></div><div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="structecvl_1_1_u_f_p_c.html">  823</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structecvl_1_1_u_f_p_c.html">UFPC</a></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;{</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">// Maximum number of labels (included background) = 2^(sizeof(unsigned) x 8)</span></div><div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="structecvl_1_1_u_f_p_c.html#ae002dee3fc4d6551797b1d454eaa6d1e">  826</a></span>&#160;    <span class="keywordtype">unsigned</span>* <a class="code" href="structecvl_1_1_u_f_p_c.html#ae002dee3fc4d6551797b1d454eaa6d1e">P_</a>;</div><div class="line"><a name="l00827"></a><span class="lineno"><a class="line" href="structecvl_1_1_u_f_p_c.html#a0233680ad101ec202165345f4d0c0e1a">  827</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structecvl_1_1_u_f_p_c.html#a0233680ad101ec202165345f4d0c0e1a">length_</a>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno"><a class="line" href="structecvl_1_1_u_f_p_c.html#a91ebc9166abd1f986e255401945f166f">  829</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structecvl_1_1_u_f_p_c.html#a91ebc9166abd1f986e255401945f166f">NewLabel</a>()</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        P_[length_] = length_;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">return</span> length_++;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="structecvl_1_1_u_f_p_c.html#aa0664e3a00e0c760aba5600f321aeab8">  835</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structecvl_1_1_u_f_p_c.html#aa0664e3a00e0c760aba5600f321aeab8">Merge</a>(<span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j)</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="comment">// FindRoot(i)</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordtype">unsigned</span> root(i);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">while</span> (P_[root] &lt; root) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            root = P_[root];</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">if</span> (i != j) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="comment">// FindRoot(j)</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordtype">unsigned</span> root_j(j);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">while</span> (P_[root_j] &lt; root_j) {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                root_j = P_[root_j];</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">if</span> (root &gt; root_j) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                root = root_j;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="comment">// SetRoot(j, root);</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">while</span> (P_[j] &lt; j) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="keywordtype">unsigned</span> t = P_[j];</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                P_[j] = root;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                j = t;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            P_[j] = root;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="comment">// SetRoot(i, root);</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">while</span> (P_[i] &lt; i) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordtype">unsigned</span> t = P_[i];</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            P_[i] = root;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            i = t;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        P_[i] = root;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">return</span> root;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;};</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#aef0e6da47bb68f1c46706fd6e6c21e3b">  870</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#aed7ae9e9c78f257354b6c638521cc1ab">CpuHal::ConnectedComponentsLabeling</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;{</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>, DataType::int32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::GRAY, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> h = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[1];</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> w = src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>[0];</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="structecvl_1_1_u_f_p_c.html">UFPC</a> ufpc;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">unsigned</span>*&amp; P = ufpc.<a class="code" href="structecvl_1_1_u_f_p_c.html#ae002dee3fc4d6551797b1d454eaa6d1e">P_</a>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">unsigned</span>&amp; P_length = ufpc.<a class="code" href="structecvl_1_1_u_f_p_c.html#a0233680ad101ec202165345f4d0c0e1a">length_</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    P = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[((size_t)((h + 1) / 2) * (<span class="keywordtype">size_t</span>)((w + 1) / 2) + 1)];</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    P[0] = 0; <span class="comment">// First label is for background pixels</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    P_length = 1;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordtype">int</span> e_rows = h &amp; 0xfffffffe;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordtype">bool</span> o_rows = h % 2 == 1;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordtype">int</span> e_cols = w &amp; 0xfffffffe;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordtype">bool</span> o_cols = w % 2 == 1;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// We work with 2x2 blocks</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// +-+-+-+</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// |P|Q|R|</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// +-+-+-+</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// |S|X|</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// +-+-+</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// The pixels are named as follows</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// +---+---+---+</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// |a b|c d|e f|</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// |g h|i j|k l|</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// +---+---+---+</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="comment">// |m n|o p|</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// |q r|s t|</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">// +---+---+</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">// Pixels a, f, l, q are not needed, since we need to understand the</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// the connectivity between these blocks and those pixels only matter</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">// when considering the outer connectivities</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// A bunch of defines used to check if the pixels are foreground,</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// without going outside the image limits.</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// First scan</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">// Define Conditions and Actions</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="preprocessor">#define CONDITION_B img_row_prev_prev[c-1]&gt;0</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#define CONDITION_C img_row_prev_prev[c]&gt;0</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="preprocessor">#define CONDITION_D img_row_prev_prev[c+1]&gt;0</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">#define CONDITION_E img_row_prev_prev[c+2]&gt;0</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#define CONDITION_G img_row_prev[c-2]&gt;0</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">#define CONDITION_H img_row_prev[c-1]&gt;0</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor">#define CONDITION_I img_row_prev[c]&gt;0</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#define CONDITION_J img_row_prev[c+1]&gt;0</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor">#define CONDITION_K img_row_prev[c+2]&gt;0</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor">#define CONDITION_M img_row[c-2]&gt;0</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="preprocessor">#define CONDITION_N img_row[c-1]&gt;0</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="preprocessor">#define CONDITION_O img_row[c]&gt;0</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#define CONDITION_P img_row[c+1]&gt;0</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="preprocessor">#define CONDITION_R img_row_fol[c-1]&gt;0</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">#define CONDITION_S img_row_fol[c]&gt;0</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="preprocessor">#define CONDITION_T img_row_fol[c+1]&gt;0</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">// Action 1: No action</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">#define ACTION_1 img_labels_row[c] = 0;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                               <span class="comment">// Action 2: New label (the block has foreground pixels and is not connected to anything else)</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#define ACTION_2 img_labels_row[c] = ufpc.NewLabel();</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                               <span class="comment">//Action 3: Assign label of block P</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#define ACTION_3 img_labels_row[c] = img_labels_row_prev_prev[c - 2];</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                               <span class="comment">// Action 4: Assign label of block Q</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#define ACTION_4 img_labels_row[c] = img_labels_row_prev_prev[c];</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                               <span class="comment">// Action 5: Assign label of block R</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor">#define ACTION_5 img_labels_row[c] = img_labels_row_prev_prev[c + 2];</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                               <span class="comment">// Action 6: Assign label of block S</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="preprocessor">#define ACTION_6 img_labels_row[c] = img_labels_row[c - 2];</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                               <span class="comment">// Action 7: Merge labels of block P and Q</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="preprocessor">#define ACTION_7 img_labels_row[c] = ufpc.Merge(img_labels_row_prev_prev[c - 2], img_labels_row_prev_prev[c]);</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                               <span class="comment">//Action 8: Merge labels of block P and R</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="preprocessor">#define ACTION_8 img_labels_row[c] = ufpc.Merge(img_labels_row_prev_prev[c - 2], img_labels_row_prev_prev[c + 2]);</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                               <span class="comment">// Action 9 Merge labels of block P and S</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="preprocessor">#define ACTION_9 img_labels_row[c] = ufpc.Merge(img_labels_row_prev_prev[c - 2], img_labels_row[c - 2]);</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                               <span class="comment">// Action 10 Merge labels of block Q and R</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor">#define ACTION_10 img_labels_row[c] = ufpc.Merge(img_labels_row_prev_prev[c], img_labels_row_prev_prev[c + 2]);</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                               <span class="comment">// Action 11: Merge labels of block Q and S</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor">#define ACTION_11 img_labels_row[c] = ufpc.Merge(img_labels_row_prev_prev[c], img_labels_row[c - 2]);</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                               <span class="comment">// Action 12: Merge labels of block R and S</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="preprocessor">#define ACTION_12 img_labels_row[c] = ufpc.Merge(img_labels_row_prev_prev[c + 2], img_labels_row[c - 2]);</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                               <span class="comment">// Action 13: Merge labels of block P, Q and R</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="preprocessor">#define ACTION_13 img_labels_row[c] = ufpc.Merge(ufpc.Merge(img_labels_row_prev_prev[c - 2], img_labels_row_prev_prev[c]), img_labels_row_prev_prev[c + 2]);</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                               <span class="comment">// Action 14: Merge labels of block P, Q and S</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="preprocessor">#define ACTION_14 img_labels_row[c] = ufpc.Merge(ufpc.Merge(img_labels_row_prev_prev[c - 2], img_labels_row_prev_prev[c]), img_labels_row[c - 2]);</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                               <span class="comment">//Action 15: Merge labels of block P, R and S</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor">#define ACTION_15 img_labels_row[c] = ufpc.Merge(ufpc.Merge(img_labels_row_prev_prev[c - 2], img_labels_row_prev_prev[c + 2]), img_labels_row[c - 2]);</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                               <span class="comment">//Action 16: labels of block Q, R and S</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#define ACTION_16 img_labels_row[c] = ufpc.Merge(ufpc.Merge(img_labels_row_prev_prev[c], img_labels_row_prev_prev[c + 2]), img_labels_row[c - 2]);</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">if</span> (h == 1) {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">// Single line</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordtype">int</span> r = 0;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row = src.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, 0, 0 });</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row = reinterpret_cast&lt;unsigned*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, 0, 0 }));</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordtype">int</span> c = -2;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="labeling__bolelli__2019__forest__singleline_8inc.html">labeling_bolelli_2019_forest_singleline.inc</a>&quot;</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">// More than one line</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="comment">// First couple of lines</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordtype">int</span> r = 0;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row = src.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, 0, 0 });</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row = reinterpret_cast&lt;unsigned*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, 0, 0 }));</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_fol = img_row + src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordtype">int</span> c = -2;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="labeling__bolelli__2019__forest__firstline_8inc.html">labeling_bolelli_2019_forest_firstline.inc</a>&quot;</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="comment">// Every other line but the last one if image has an odd number of rows</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 2; r &lt; e_rows; r += 2) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="comment">// Get rows pointer</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row = src.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 });</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_prev = img_row - src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_prev_prev = img_row_prev - src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_fol = img_row + src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row = reinterpret_cast&lt;unsigned*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 }));</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row_prev_prev = reinterpret_cast&lt;unsigned*&gt;((reinterpret_cast&lt;uint8_t*&gt;(img_labels_row) - 2 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1]));</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordtype">int</span> c = -2;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">goto</span> tree_0;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="labeling__bolelli__2019__forest_8inc.html">labeling_bolelli_2019_forest.inc</a>&quot;</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="comment">// Last line (in case the rows are odd)</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">if</span> (o_rows) {</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordtype">int</span> r = h - 1;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row = src.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 });</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_prev = img_row - src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_prev_prev = img_row_prev - src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row = reinterpret_cast&lt;unsigned*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 }));</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row_prev_prev = reinterpret_cast&lt;unsigned*&gt;((reinterpret_cast&lt;uint8_t*&gt;(img_labels_row) - 2 * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1]));</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordtype">int</span> c = -2;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="labeling__bolelli__2019__forest__lastline_8inc.html">labeling_bolelli_2019_forest_lastline.inc</a>&quot;</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// Undef Conditions and Actions</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#undef ACTION_1</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="preprocessor">#undef ACTION_2</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#undef ACTION_3</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="preprocessor">#undef ACTION_4</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="preprocessor">#undef ACTION_5</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor">#undef ACTION_6</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="preprocessor">#undef ACTION_7</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor">#undef ACTION_8</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="preprocessor">#undef ACTION_9</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor">#undef ACTION_10</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="preprocessor">#undef ACTION_11</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="preprocessor">#undef ACTION_12</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="preprocessor">#undef ACTION_13</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="preprocessor">#undef ACTION_14</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor">#undef ACTION_15</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor">#undef ACTION_16</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">#undef CONDITION_B</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor">#undef CONDITION_C</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor">#undef CONDITION_D</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="preprocessor">#undef CONDITION_E</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor">#undef CONDITION_G</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor">#undef CONDITION_H</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="preprocessor">#undef CONDITION_I</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="preprocessor">#undef CONDITION_J</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#undef CONDITION_K</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="preprocessor">#undef CONDITION_M</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor">#undef CONDITION_N</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor">#undef CONDITION_O</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="preprocessor">#undef CONDITION_P</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor">#undef CONDITION_R</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="preprocessor">#undef CONDITION_S</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#undef CONDITION_T</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">// Flatten</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordtype">unsigned</span> k = 1;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; P_length; ++i) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> (P[i] &lt; i) {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            P[i] = P[P[i]];</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            P[i] = k;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            k = k + 1;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_labels_ = k;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">// Second scan</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordtype">int</span> r = 0;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">for</span> (; r &lt; e_rows; r += 2) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="comment">// Get rows pointer</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row = src.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 });</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row_fol = img_row + src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1];</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row = reinterpret_cast&lt;unsigned*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 }));</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row_fol = reinterpret_cast&lt;unsigned*&gt;((reinterpret_cast&lt;uint8_t*&gt;(img_labels_row) + tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1]));</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordtype">int</span> c = 0;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">for</span> (; c &lt; e_cols; c += 2) {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <span class="keywordtype">int</span> iLabel = img_labels_row[c];</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="keywordflow">if</span> (iLabel &gt; 0) {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                iLabel = P[iLabel];</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <span class="keywordflow">if</span> (img_row[c] &gt; 0)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                    img_labels_row[c] = iLabel;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                    img_labels_row[c] = 0;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                <span class="keywordflow">if</span> (img_row[c + 1] &gt; 0)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                    img_labels_row[c + 1] = iLabel;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                    img_labels_row[c + 1] = 0;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <span class="keywordflow">if</span> (img_row_fol[c] &gt; 0)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                    img_labels_row_fol[c] = iLabel;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                    img_labels_row_fol[c] = 0;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <span class="keywordflow">if</span> (img_row_fol[c + 1] &gt; 0)</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                    img_labels_row_fol[c + 1] = iLabel;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    img_labels_row_fol[c + 1] = 0;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                img_labels_row[c] = 0;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                img_labels_row[c + 1] = 0;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                img_labels_row_fol[c] = 0;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                img_labels_row_fol[c + 1] = 0;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="comment">// Last column if the number of columns is odd</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">if</span> (o_cols) {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keywordtype">int</span> iLabel = img_labels_row[c];</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="keywordflow">if</span> (iLabel &gt; 0) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                iLabel = P[iLabel];</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="keywordflow">if</span> (img_row[c] &gt; 0)</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    img_labels_row[c] = iLabel;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    img_labels_row[c] = 0;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                <span class="keywordflow">if</span> (img_row_fol[c] &gt; 0)</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    img_labels_row_fol[c] = iLabel;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    img_labels_row_fol[c] = 0;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            }</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                img_labels_row[c] = 0;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                img_labels_row_fol[c] = 0;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// Last row if the number of rows is odd</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">if</span> (o_rows) {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="comment">// Get rows pointer</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> img_row = src.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 });</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordtype">unsigned</span>* <span class="keyword">const</span> img_labels_row = reinterpret_cast&lt;unsigned*&gt;(tmp.<a class="code" href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">Ptr</a>({ 0, r, 0 }));</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordtype">int</span> c = 0;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keywordflow">for</span> (; c &lt; e_cols; c += 2) {</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordtype">int</span> iLabel = img_labels_row[c];</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">if</span> (iLabel &gt; 0) {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                iLabel = P[iLabel];</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                <span class="keywordflow">if</span> (img_row[c] &gt; 0)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    img_labels_row[c] = iLabel;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                    img_labels_row[c] = 0;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                <span class="keywordflow">if</span> (img_row[c + 1] &gt; 0)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                    img_labels_row[c + 1] = iLabel;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    img_labels_row[c + 1] = 0;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                img_labels_row[c] = 0;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                img_labels_row[c + 1] = 0;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="comment">// Last column if the number of columns is odd</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">if</span> (o_cols) {</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <span class="keywordtype">int</span> iLabel = img_labels_row[c];</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">if</span> (iLabel &gt; 0) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                iLabel = P[iLabel];</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                <span class="keywordflow">if</span> (img_row[c] &gt; 0)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                    img_labels_row[c] = iLabel;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    img_labels_row[c] = 0;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            }</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                img_labels_row[c] = 0;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        }</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keyword">delete</span>[] P;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;}</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a9c275b262faec5a980543866b3f324ba"> 1182</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#abfd80fb03b661615f126a640c47e36c4">CpuHal::FindContours</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, vector&lt;vector&lt;ecvl::Point2i&gt;&gt;&amp; contours)</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;{</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    cv::Mat cv_src = <a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ecvl::ImageToMat</a>(src);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    vector&lt;vector&lt;cv::Point&gt;&gt; cv_contours;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    vector&lt;cv::Vec4i&gt; hierarchy;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    cv::findContours(cv_src, cv_contours, hierarchy, cv::RETR_LIST, cv::CHAIN_APPROX_NONE);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    contours.resize(cv_contours.size());</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(cv_contours); ++i) {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        vector&lt;ecvl::Point2i&gt; t(cv_contours[i].size());</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(cv_contours[i]); ++j) {</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            t[j] = <a class="code" href="namespaceecvl.html#ac60a2f087e03fdac8ad7969eaf351616">Point2i</a>{ cv_contours[i][j].x, cv_contours[i][j].y };</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        contours[i] = t;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    }</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;}</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a3b26c62f82261b94e5531e3f60c65ac5"> 1202</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ac4f0336afb75df754337fb55a106b12a">CpuHal::Stack</a>(<span class="keyword">const</span> vector&lt;Image&gt;&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst)</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;{</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> n_images = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(src);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; src_0 = src[0];</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// If src is a vector of xyc Image</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">if</span> (src_0.channels_ == <span class="stringliteral">&quot;xyc&quot;</span>) {</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="classecvl_1_1_image.html">Image</a> tmp({ src_0.dims_[0], src_0.dims_[1], n_images * src_0.dims_[2] }, src_0.elemtype_, <span class="stringliteral">&quot;xyo&quot;</span>, src_0.colortype_, src_0.spacings_, src_0.dev_);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_images; ++i) {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; src[i].Channels(); ++j) {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                memcpy(tmp.data_ + src[i].strides_[2] * (i + j * n_images), src[i].data_ + src[i].strides_[2] * j, src[i].strides_[2]);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        dst = std::move(tmp);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <a class="code" href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;}</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#ae2bfafb987181e59aa08189f8f4fb817"> 1223</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a1ef076d9934ba5b0228f477d60fdb64c">CpuHal::HConcat</a>(<span class="keyword">const</span> vector&lt;Image&gt;&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst)</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;{</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> n_images = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(src);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; src_0 = src[0];</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordtype">size_t</span> c_pos = src_0.channels_.find(<span class="charliteral">&#39;c&#39;</span>);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordtype">size_t</span> x_pos = src_0.channels_.find(<span class="charliteral">&#39;x&#39;</span>);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordtype">size_t</span> y_pos = src_0.channels_.find(<span class="charliteral">&#39;y&#39;</span>);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> src_height = src_0.Height();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> src_channels = src_0.Channels();</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">// calculate the width of resulting image</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    vector&lt;int&gt; cumul_strides;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordtype">int</span> new_width = 0, src_stride_y_tot = 0;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_images; ++i) {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        cumul_strides.push_back(src_stride_y_tot);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        new_width += src[i].dims_[x_pos];</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        src_stride_y_tot += src[i].strides_[y_pos];</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    vector&lt;int&gt; new_dims(src_0.dims_);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    new_dims[x_pos] = new_width;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(new_dims, src_0.elemtype_, src_0.channels_, src_0.colortype_, src_0.spacings_, src_0.dev_);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">// If src is a vector of xyc Image(s)</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> (src_0.channels_ == <span class="stringliteral">&quot;xyc&quot;</span>) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">// 4x time faster than generic version below</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="comment">// Fill each tmp color plane by row</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; src_0.Channels(); ++i) {</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src_0.dims_[1]; ++r) {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; n_images; ++c) {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                    memcpy(tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + cumul_strides[c] + r * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[1] + i * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2], src[c].data_ + r * src[c].strides_[1] + i * src[c].strides_[2], src[c].strides_[1]);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    }</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordtype">int</span> src_stride_x = src_0.strides_[x_pos];</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordtype">int</span> src_stride_y = src_0.strides_[y_pos];</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        vector&lt;vector&lt;uint8_t*&gt;&gt; src_vch(src_channels);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        vector&lt;uint8_t*&gt;tmp_vch(src_channels);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="comment">// Get the pointers to channels starting pixels</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src_channels; ++c) {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_images; ++i) {</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                src_vch[c].push_back(src[i].data_ + c * src[i].strides_[c_pos]);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            }</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            tmp_vch[c] = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + c * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src_height; ++r) {</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="comment">// Get the address of next row</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <span class="keywordtype">int</span> tmp_pos = r * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[y_pos];</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <span class="keywordtype">int</span> counter = 0;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_images; ++i) {</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                <span class="keywordtype">int</span> src_pos = r * src[i].strides_[y_pos];</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c_i = 0; c_i &lt; src[i].Width(); ++c_i) {</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                    <span class="keywordtype">int</span> p_tmp = tmp_pos + src_stride_x * counter++;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                    <span class="keywordtype">int</span> p_src = src_pos + src_stride_x * c_i;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="preprocessor">                case DataType::type: \</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="preprocessor">                    for (int ch = 0; ch &lt; src_channels; ++ch) { \</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="preprocessor">                        *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p_tmp) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch][i] + p_src); \</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="preprocessor">                    } \</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="preprocessor">                    break;</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                    <span class="keywordflow">switch</span> (src_0.elemtype_) {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                    }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                }</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            }</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;}</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a18a4249843d6a80c213d868e34066a74"> 1300</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a8e3c4feba7fabfb06ed2d617e1640f79">CpuHal::VConcat</a>(<span class="keyword">const</span> vector&lt;Image&gt;&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst)</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> n_images = <a class="code" href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">vsize</a>(src);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; src_0 = src[0];</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordtype">size_t</span> c_pos = src_0.channels_.find(<span class="charliteral">&#39;c&#39;</span>);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordtype">size_t</span> x_pos = src_0.channels_.find(<span class="charliteral">&#39;x&#39;</span>);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordtype">size_t</span> y_pos = src_0.channels_.find(<span class="charliteral">&#39;y&#39;</span>);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> src_width = src_0.Width();</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> src_channels = src_0.Channels();</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="comment">// calculate the width of resulting image</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    vector&lt;int&gt; cumul_strides;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordtype">int</span> new_height = 0, src_stride_c_tot = 0;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_images; ++i) {</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        cumul_strides.push_back(src_stride_c_tot);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        new_height += src[i].dims_[y_pos];</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        src_stride_c_tot += src[i].strides_[c_pos];</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    vector&lt;int&gt; new_dims(src_0.dims_);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    new_dims[y_pos] = new_height;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(new_dims, src_0.elemtype_, src_0.channels_, src_0.colortype_, src_0.spacings_, src_0.dev_);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// If src is a vector of xyc Image(s)</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">if</span> (src_0.channels_ == <span class="stringliteral">&quot;xyc&quot;</span>) {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="comment">// 4x time faster than generic version below</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="comment">// Fill each tmp color plane concatenating every src color plane</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; src_0.Channels(); ++i) {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; n_images; ++c) {</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                memcpy(tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + cumul_strides[c] + i * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[2], src[c].data_ + i * src[c].strides_[2], src[c].strides_[2]);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            }</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        }</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    }</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordtype">int</span> src_stride_x = src_0.strides_[x_pos];</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        vector&lt;vector&lt;uint8_t*&gt;&gt; src_vch(src_channels);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        vector&lt;uint8_t*&gt;tmp_vch(src_channels);</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="comment">// Get the pointers to channels starting pixels</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src_channels; ++c) {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_images; ++i) {</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                src_vch[c].push_back(src[i].data_ + c * src[i].strides_[c_pos]);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            }</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            tmp_vch[c] = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + c * tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, offset = 0; i &lt; n_images; offset += src[i].Height(), ++i) {</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src[i].Height(); ++r) {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                <span class="comment">// Get the address of next row</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                <span class="keywordtype">int</span> tmp_pos = (offset + r) * src[i].strides_[y_pos];</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                <span class="keywordtype">int</span> src_pos = r * src[i].strides_[y_pos];</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src_width; ++c) {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    <span class="keywordtype">int</span> p_tmp = tmp_pos + src_stride_x * c;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    <span class="keywordtype">int</span> p_src = src_pos + src_stride_x * c;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="preprocessor">                case DataType::type: \</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="preprocessor">                    for (int ch = 0; ch &lt; src_channels; ++ch) { \</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="preprocessor">                        *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p_tmp) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch][i] + p_src); \</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="preprocessor">                    } \</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="preprocessor">                    break;</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    <span class="keywordflow">switch</span> (src_0.elemtype_) {</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                    }</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            }</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        }</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#abecc76f6479c963394db7c51d572f7b1"> 1373</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a09f0ab2d8976efcb4c383b711d3082c3">CpuHal::Morphology</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <a class="code" href="namespaceecvl.html#a4696838ef2eb912185348d2585a3ce36">MorphType</a> op, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; kernel, <a class="code" href="namespaceecvl.html#ac60a2f087e03fdac8ad7969eaf351616">Point2i</a> anchor, <span class="keywordtype">int</span> iterations, <a class="code" href="namespaceecvl.html#ad5dbd126a6cf39db0ae8fa2b013931d3">BorderType</a> border_type, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; border_value)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;{</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keyword">using namespace </span>cv;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    Mat src_(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src));</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    Mat kernel_(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(kernel));</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    Mat dst_;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    Point anchor_{ anchor[0], anchor[1] };</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">int</span> op_ = static_cast&lt;int&gt;(op);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    morphologyEx(src_, dst_, op_, kernel_, anchor_, iterations, static_cast&lt;int&gt;(border_type), border_value);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">MatToImage</a>(dst_);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;}</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#ade5146b50b47183bceab6a2944ea27b8"> 1389</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#adecccefb7d437197c6bc805e86eb0811">CpuHal::Inpaint</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; inpaintMask, <span class="keywordtype">double</span> inpaintRadius, <a class="code" href="namespaceecvl.html#a291f22c1d709ec3ec230aa1b5e9325d2">InpaintType</a> flag)</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;{</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keyword">using namespace </span>cv;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    Mat src_(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src));</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    Mat inpaintMask_(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(inpaintMask));</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    Mat dst_;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordtype">int</span> flag_ = static_cast&lt;int&gt;(flag);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    cv::inpaint(src_, inpaintMask_, dst_, inpaintRadius, flag_);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">MatToImage</a>(dst_);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;}</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#ac419fee52b43f72ebff3311066dfcf59"> 1404</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a73979fb8877322e81048522db568a82d">CpuHal::MeanStdDev</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, std::vector&lt;double&gt;&amp; mean, std::vector&lt;double&gt;&amp; stddev)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;{</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keyword">using namespace </span>cv;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    Mat src_(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src));</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    Scalar mean_, stddev_;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    mean.clear();</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    stddev.clear();</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    meanStdDev(src_, mean_, stddev_);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; src.<a class="code" href="classecvl_1_1_image.html#a7b6db514661e150f16a534abe577c859">Channels</a>(); ++i) {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        mean.push_back(mean_[i]);</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        stddev.push_back(stddev_[i]);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    }</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;}</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a70744f9175b4448e43dd57b508aab0b6"> 1421</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#aeb20ecb4f245bbd530c845e96d4b5c59">CpuHal::Transpose</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst)</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;{</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordtype">size_t</span> c_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;c&#39;</span>);</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordtype">size_t</span> x_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;x&#39;</span>);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordtype">size_t</span> y_pos = src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>.find(<span class="charliteral">&#39;y&#39;</span>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (c_pos == string::npos || x_pos == string::npos || y_pos == string::npos) {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <a class="code" href="standard__errors_8h.html#a7b2b9053b329e941dcc0a8c14017b9bb">ECVL_ERROR_WRONG_PARAMS</a>(<span class="stringliteral">&quot;Malformed src image&quot;</span>)</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordtype">int</span> src_width = src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>();</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordtype">int</span> src_height = src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>();</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordtype">int</span> src_channels = src.<a class="code" href="classecvl_1_1_image.html#a7b6db514661e150f16a534abe577c859">Channels</a>();</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    vector&lt;int&gt; new_dims(src.<a class="code" href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">dims_</a>);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    new_dims[x_pos] = src_height;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    new_dims[y_pos] = src_width;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> tmp(new_dims, src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>, src.<a class="code" href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">channels_</a>, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">spacings_</a>, src.<a class="code" href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">dev_</a>);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">int</span> src_stride_c = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordtype">int</span> tmp_stride_c = tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[c_pos];</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordtype">int</span> src_stride_x = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[x_pos];</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordtype">int</span> tmp_stride_x = tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[x_pos];</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordtype">int</span> src_stride_y = src.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[y_pos];</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordtype">int</span> tmp_stride_y = tmp.<a class="code" href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">strides_</a>[y_pos];</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    vector&lt;uint8_t*&gt; src_vch(src_channels), tmp_vch(src_channels);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// Get the pointers to channels starting pixels</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; src_channels; ++i) {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        src_vch[i] = src.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + i * src_stride_c;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        tmp_vch[i] = tmp.<a class="code" href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">data_</a> + i * tmp_stride_c;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    }</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; src_width; ++c) {</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="comment">// Get the address of pixels in current row</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="keywordtype">int</span> pos = src_stride_x * c;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordtype">int</span> pos_dst = tmp_stride_y * c;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; src_height; ++r) {</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <span class="comment">// Get the address of next row</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="keywordtype">int</span> p1 = pos + r * src_stride_y;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <span class="keywordtype">int</span> p2 = pos_dst + r * tmp_stride_x;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="preprocessor">#define ECVL_TUPLE(type, ...) \</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="preprocessor">            case DataType::type: \</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="preprocessor">                for (int ch = 0; ch &lt; src_channels; ++ch) { \</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="preprocessor">                    *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(tmp_vch[ch] + p2) = *reinterpret_cast&lt;TypeInfo_t&lt;DataType::type&gt;*&gt;(src_vch[ch] + p1); \</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor">                } \</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">                break;</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <span class="keywordflow">switch</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a>) {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="datatype__existing__tuples_8inc_8h.html">ecvl/core/datatype_existing_tuples.inc.h</a>&quot;</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            }</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor">#undef ECVL_TUPLE</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        }</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    dst = std::move(tmp);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;}</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="namespaceecvl.html#a43ed196d5b735918c287436a02f275cb"> 1482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a43ed196d5b735918c287436a02f275cb">FillCoordsVector</a>(vector&lt;float&gt;&amp; v, vector&lt;float&gt;&amp; steps, <span class="keywordtype">int</span> size, <span class="keywordtype">int</span> num_steps)</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;{</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">int</span> step = size / num_steps;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordtype">int</span> prev = 0, start = 0, end = 0, x = 0;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordtype">float</span> cur = 0, diff = 0, div = 0;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx &lt; num_steps; ++idx) {</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        x = idx * step;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        start = x;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        end = x + step;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        <span class="keywordflow">if</span> (end &gt; size) {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            end = size;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            cur = static_cast&lt;float&gt;(size);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        }</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            cur = prev + step * steps[idx];</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        diff = cur - prev;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        div = diff / (step - 1);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        v[start] = static_cast&lt;float&gt;(prev);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = start; j &lt; end - 1; ++j) {</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            v[j + 1] = v[j] + div;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        }</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        prev = static_cast&lt;int&gt;(cur);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    }</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;}</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#ace651fdc48970d8c0e5c211a662364b7"> 1511</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a1448dd4601763e88cdeba26c6c1ef310">CpuHal::GridDistortion</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">int</span> num_steps, <span class="keyword">const</span> std::array&lt;float, 2&gt;&amp; distort_limit,</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp, <a class="code" href="namespaceecvl.html#ad5dbd126a6cf39db0ae8fa2b013931d3">BorderType</a> border_type, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; border_value, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> seed)</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;{</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    std::default_random_engine re(std::random_device{}());</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">if</span> (seed != re.default_seed) {</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        re.seed(seed);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    }</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    vector&lt;float&gt; xsteps, ysteps;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_steps + 1; ++i) {</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        xsteps.push_back(1 + std::uniform_real_distribution&lt;float&gt;(distort_limit[0], distort_limit[1])(re));</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        ysteps.push_back(1 + std::uniform_real_distribution&lt;float&gt;(distort_limit[0], distort_limit[1])(re));</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordtype">int</span> height = src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>();</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordtype">int</span> width = src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>();</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">if</span> (num_steps == 0) {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <a class="code" href="standard__errors_8h.html#aa415d0e113911df8a4beb5bb46ebf5ba">ECVL_ERROR_DIVISION_BY_ZERO</a></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordtype">int</span> x_step = width / num_steps;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    vector&lt;float&gt; xx(width, 0.);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="keywordtype">int</span> y_step = height / num_steps;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    vector&lt;float&gt; yy(height, 0.);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <a class="code" href="namespaceecvl.html#a43ed196d5b735918c287436a02f275cb">FillCoordsVector</a>(xx, xsteps, width, num_steps);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <a class="code" href="namespaceecvl.html#a43ed196d5b735918c287436a02f275cb">FillCoordsVector</a>(yy, ysteps, height, num_steps);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> map_x({ width, height, 1 }, DataType::float32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::none);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> map_y({ width, height, 1 }, DataType::float32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::none);</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; height; ++i) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        memcpy(map_x.data_ + (width * i * map_x.elemsize_), xx.data(), width * map_x.elemsize_);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    }</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; height; ++r) {</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; width; ++c) {</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            memcpy(map_y.data_ + map_y.elemsize_ * c + map_y.strides_[1] * r, yy.data() + r, map_y.elemsize_);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        }</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    }</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> == DataType::int8 || src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> == DataType::int32) {</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        interp = InterpolationType::nearest;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    }</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    cv::Mat tmp;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    cv::remap(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), tmp, <a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(map_x), <a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(map_y), <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp), static_cast&lt;int&gt;(border_type), border_value);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">MatToImage</a>(tmp);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">if</span> (dst.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> != src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <a class="code" href="namespaceecvl.html#a93b998f334d8d58ade52f8c2f7655609">ChangeColorSpace</a>(dst, dst, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    }</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;}</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#a493262c0ddb6b18d97d47386b736e722"> 1566</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#ac0cadcb0a4b3bc15cb00dade7c004686">CpuHal::ElasticTransform</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keywordtype">double</span> alpha, <span class="keywordtype">double</span> sigma, <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp,</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <a class="code" href="namespaceecvl.html#ad5dbd126a6cf39db0ae8fa2b013931d3">BorderType</a> border_type, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; border_value, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> seed)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;{</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    std::default_random_engine re(std::random_device{}());</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">if</span> (seed != re.default_seed) {</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        re.seed(seed);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    }</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordtype">int</span> height = src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>();</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordtype">int</span> width = src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>();</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> dx({ src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>(), src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>(), 1 }, DataType::float32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::none);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keyword">auto</span> it = dx.<a class="code" href="classecvl_1_1_image.html#a1d589431ff9de24429b9595386a836dc">Begin</a>&lt;<span class="keywordtype">float</span>&gt;(), e = dx.End&lt;<span class="keywordtype">float</span>&gt;();</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">for</span> (; it != e; ++it) {</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        *it = std::uniform_real_distribution&lt;float&gt;(-1, 1)(re);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <a class="code" href="namespaceecvl.html#ae723594306a62266207448cf9277687a">ecvl::GaussianBlur</a>(dx, dx, 17, 17, sigma);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="namespaceecvl.html#aefb3bf550679f0b94a93825ee6e7c21a">ecvl::Mul</a>(dx, alpha, dx, dx.elemtype_);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> dy({ src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>(), src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>(), 1 }, DataType::float32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::none);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    it = dy.<a class="code" href="classecvl_1_1_image.html#a1d589431ff9de24429b9595386a836dc">Begin</a>&lt;<span class="keywordtype">float</span>&gt;(), e = dy.End&lt;<span class="keywordtype">float</span>&gt;();</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">for</span> (; it != e; ++it) {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        *it = std::uniform_real_distribution&lt;float&gt;(-1, 1)(re);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    }</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <a class="code" href="namespaceecvl.html#ae723594306a62266207448cf9277687a">ecvl::GaussianBlur</a>(dy, dy, 17, 17, sigma);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="namespaceecvl.html#aefb3bf550679f0b94a93825ee6e7c21a">ecvl::Mul</a>(dy, alpha, dy, dy.elemtype_);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    vector&lt;float&gt; width_range(width);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    vector&lt;float&gt; height_range(height);</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    iota(width_range.begin(), width_range.end(), 0.f);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    iota(height_range.begin(), height_range.end(), 0.f);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> map_x({ width, height, 1 }, DataType::float32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::none);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <a class="code" href="classecvl_1_1_image.html">Image</a> map_y({ width, height, 1 }, DataType::float32, <span class="stringliteral">&quot;xyc&quot;</span>, ColorType::none);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; height; ++i) {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        memcpy(map_x.data_ + (width * i * map_x.elemsize_), width_range.data(), width * map_x.elemsize_);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    }</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; height; ++r) {</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; width; ++c) {</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            memcpy(map_y.data_ + map_y.elemsize_ * c + map_y.strides_[1] * r, height_range.data() + r, map_y.elemsize_);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    }</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <a class="code" href="namespaceecvl.html#ab71c66befd58dc3a45874b771021893f">ecvl::Add</a>(map_x, dx, map_x, map_x.elemtype_);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <a class="code" href="namespaceecvl.html#ab71c66befd58dc3a45874b771021893f">ecvl::Add</a>(map_y, dy, map_y, map_y.elemtype_);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> == DataType::int8 || src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> == DataType::int32) {</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        interp = InterpolationType::nearest;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    cv::Mat tmp;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    cv::remap(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), tmp, <a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(map_x), <a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(map_y), <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp), static_cast&lt;int&gt;(border_type), border_value);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">MatToImage</a>(tmp);</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="keywordflow">if</span> (dst.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> != src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>) {</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <a class="code" href="namespaceecvl.html#a93b998f334d8d58ade52f8c2f7655609">ChangeColorSpace</a>(dst, dst, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;}</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div><div class="line"><a name="l01625"></a><span class="lineno"><a class="line" href="classecvl_1_1_cpu_hal.html#aa8be0e6d090bef68f79af0da1dd086d5"> 1625</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceecvl.html#a371534ebd422c20d6905bc0013bca16b">CpuHal::OpticalDistortion</a>(<span class="keyword">const</span> <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; src, <a class="code" href="classecvl_1_1_image.html">Image</a>&amp; dst, <span class="keyword">const</span> std::array&lt;float, 2&gt;&amp; distort_limit, <span class="keyword">const</span> std::array&lt;float, 2&gt;&amp; shift_limit,</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <a class="code" href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">InterpolationType</a> interp, <a class="code" href="namespaceecvl.html#ad5dbd126a6cf39db0ae8fa2b013931d3">BorderType</a> border_type, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; border_value, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> seed)</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;{</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <a class="code" href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">OpenCVAlwaysCheck</a>(src);</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    std::default_random_engine re(std::random_device{}());</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">if</span> (seed != re.default_seed) {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        re.seed(seed);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordtype">float</span> k = std::uniform_real_distribution&lt;float&gt;(distort_limit[0], distort_limit[1])(re);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordtype">float</span> dx = std::uniform_real_distribution&lt;float&gt;(shift_limit[0], shift_limit[1])(re);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordtype">float</span> dy = std::uniform_real_distribution&lt;float&gt;(shift_limit[0], shift_limit[1])(re);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordtype">int</span> height = src.<a class="code" href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">Height</a>();</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordtype">int</span> width = src.<a class="code" href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">Width</a>();</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordtype">float</span> fx = static_cast&lt;float&gt;(width);</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordtype">float</span> fy = static_cast&lt;float&gt;(height);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="keywordtype">float</span> cx = width * 0.5f + round(dx);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordtype">float</span> cy = height * 0.5f + round(dy);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordtype">float</span> data[9] = { fx, 0, cx, 0, fy, cy, 0, 0, 1 };</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordtype">float</span> data2[5] = { k, k, 0, 0, 0 };</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    cv::Mat camera_matrix = cv::Mat(3, 3, CV_32F, data);</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    cv::Mat distortion = cv::Mat(1, 5, CV_32F, data2);</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    cv::Mat map1, map2, tmp;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    cv::initUndistortRectifyMap(camera_matrix, distortion, cv::Mat(), cv::Mat(), { width, height }, CV_32FC1, map1, map2);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> == DataType::int8 || src.<a class="code" href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">elemtype_</a> == DataType::int32) {</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        interp = InterpolationType::nearest;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    }</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    cv::remap(<a class="code" href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ImageToMat</a>(src), tmp, map1, map2, <a class="code" href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">GetOpenCVInterpolation</a>(interp), static_cast&lt;int&gt;(border_type), border_value);</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    dst = <a class="code" href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">MatToImage</a>(tmp);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">if</span> (dst.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a> != src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <a class="code" href="namespaceecvl.html#a93b998f334d8d58ade52f8c2f7655609">ChangeColorSpace</a>(dst, dst, src.<a class="code" href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">colortype_</a>);</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    }</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;}</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;} <span class="comment">// namespace ecvl</span></div><div class="ttc" id="cpu__hal_8h_html"><div class="ttname"><a href="cpu__hal_8h.html">cpu_hal.h</a></div></div>
<div class="ttc" id="namespaceecvl_html_a010dd55cace0a7b700391238952f9e55"><div class="ttname"><a href="namespaceecvl.html#a010dd55cace0a7b700391238952f9e55">ecvl::ResizeDim</a></div><div class="ttdeci">void ResizeDim(const ecvl::Image &amp;src, ecvl::Image &amp;dst, const std::vector&lt; int &gt; &amp;newdims, InterpolationType interp=InterpolationType::linear)</div><div class="ttdoc">Resizes an Image to the specified dimensions.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00047">imgproc.cpp:47</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html"><div class="ttname"><a href="classecvl_1_1_image.html">ecvl::Image</a></div><div class="ttdoc">Image class.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00072">image.h:72</a></div></div>
<div class="ttc" id="labeling__bolelli__2019__forest__lastline_8inc_html"><div class="ttname"><a href="labeling__bolelli__2019__forest__lastline_8inc.html">labeling_bolelli_2019_forest_lastline.inc</a></div></div>
<div class="ttc" id="namespaceecvl_html_aefb3bf550679f0b94a93825ee6e7c21a"><div class="ttname"><a href="namespaceecvl.html#aefb3bf550679f0b94a93825ee6e7c21a">ecvl::Mul</a></div><div class="ttdeci">void Mul(const Image &amp;src1, const Image &amp;src2, Image &amp;dst, DataType dst_type=DataType::none, bool saturate=true)</div><div class="ttdef"><b>Definition:</b> <a href="arithmetic_8h_source.html#l00122">arithmetic.h:122</a></div></div>
<div class="ttc" id="namespaceecvl_html_abf7537b0520ba88dd624839bc7a951dd"><div class="ttname"><a href="namespaceecvl.html#abf7537b0520ba88dd624839bc7a951dd">ecvl::CoarseDropout</a></div><div class="ttdeci">void CoarseDropout(const Image &amp;src, Image &amp;dst, double p, double drop_size, bool per_channel)</div><div class="ttdoc">Sets rectangular areas within an Image to zero.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00289">imgproc.cpp:289</a></div></div>
<div class="ttc" id="namespaceecvl_html_a1448dd4601763e88cdeba26c6c1ef310"><div class="ttname"><a href="namespaceecvl.html#a1448dd4601763e88cdeba26c6c1ef310">ecvl::GridDistortion</a></div><div class="ttdeci">void GridDistortion(const Image &amp;src, Image &amp;dst, int num_steps=5, const std::array&lt; float, 2 &gt; &amp;distort_limit={ -0.3f, 0.3f }, InterpolationType interp=InterpolationType::linear, BorderType border_type=BorderType::BORDER_REFLECT_101, const int &amp;border_value=0, const unsigned seed=std::default_random_engine::default_seed)</div><div class="ttdoc">Randomly stretch or reduce each cell of the grid in which the input Image is divided into....</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00483">imgproc.cpp:483</a></div></div>
<div class="ttc" id="structecvl_1_1_u_f_p_c_html"><div class="ttname"><a href="structecvl_1_1_u_f_p_c.html">ecvl::UFPC</a></div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00823">cpu_hal_imgproc.cpp:823</a></div></div>
<div class="ttc" id="namespaceecvl_html_a291f22c1d709ec3ec230aa1b5e9325d2"><div class="ttname"><a href="namespaceecvl.html#a291f22c1d709ec3ec230aa1b5e9325d2">ecvl::InpaintType</a></div><div class="ttdeci">InpaintType</div><div class="ttdoc">Enum class representing the ECVL inpaint types.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8h_source.html#l00363">imgproc.h:363</a></div></div>
<div class="ttc" id="namespaceecvl_html_a93b998f334d8d58ade52f8c2f7655609"><div class="ttname"><a href="namespaceecvl.html#a93b998f334d8d58ade52f8c2f7655609">ecvl::ChangeColorSpace</a></div><div class="ttdeci">void ChangeColorSpace(const Image &amp;src, Image &amp;dst, ColorType new_type)</div><div class="ttdoc">Copies the source Image into destination Image changing the color space.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00101">imgproc.cpp:101</a></div></div>
<div class="ttc" id="standard__errors_8h_html_a7b2b9053b329e941dcc0a8c14017b9bb"><div class="ttname"><a href="standard__errors_8h.html#a7b2b9053b329e941dcc0a8c14017b9bb">ECVL_ERROR_WRONG_PARAMS</a></div><div class="ttdeci">#define ECVL_ERROR_WRONG_PARAMS(msg)</div><div class="ttdef"><b>Definition:</b> <a href="standard__errors_8h_source.html#l00025">standard_errors.h:25</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a9bb099eb9fbebfede02d2457d93a3f43"><div class="ttname"><a href="classecvl_1_1_image.html#a9bb099eb9fbebfede02d2457d93a3f43">ecvl::Image::Width</a></div><div class="ttdeci">int Width() const</div><div class="ttdoc">Returns the width of Image.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00476">image.h:476</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_ac3bdae3b8e7b4b02fa137f4a4c900cc2"><div class="ttname"><a href="classecvl_1_1_image.html#ac3bdae3b8e7b4b02fa137f4a4c900cc2">ecvl::Image::data_</a></div><div class="ttdeci">uint8_t * data_</div><div class="ttdoc">Pointer to Image data.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00165">image.h:165</a></div></div>
<div class="ttc" id="namespaceecvl_html_a09f0ab2d8976efcb4c383b711d3082c3"><div class="ttname"><a href="namespaceecvl.html#a09f0ab2d8976efcb4c383b711d3082c3">ecvl::Morphology</a></div><div class="ttdeci">void Morphology(const Image &amp;src, Image &amp;dst, MorphType op, Image &amp;kernel, Point2i anchor={ -1, -1 }, int iterations=1, BorderType border_type=BorderType::BORDER_CONSTANT, const int &amp;border_value=0)</div><div class="ttdoc">Performs advanced morphological transformations using an erosion and dilation as basic operations.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00453">imgproc.cpp:453</a></div></div>
<div class="ttc" id="namespaceecvl_html_adecccefb7d437197c6bc805e86eb0811"><div class="ttname"><a href="namespaceecvl.html#adecccefb7d437197c6bc805e86eb0811">ecvl::Inpaint</a></div><div class="ttdeci">void Inpaint(const Image &amp;src, Image &amp;dst, const Image &amp;inpaintMask, double inpaintRadius, InpaintType flag=InpaintType::INPAINT_TELEA)</div><div class="ttdoc">Restores the selected region in an image using the region neighborhood.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00460">imgproc.cpp:460</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a3a8898ed7d960538843443c99e49ee34"><div class="ttname"><a href="classecvl_1_1_image.html#a3a8898ed7d960538843443c99e49ee34">ecvl::Image::channels_</a></div><div class="ttdeci">std::string channels_</div><div class="ttdoc">String which describes how Image planes are organized.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00130">image.h:130</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a1855a32639c8385ba96f9e151ca882d2"><div class="ttname"><a href="classecvl_1_1_image.html#a1855a32639c8385ba96f9e151ca882d2">ecvl::Image::datasize_</a></div><div class="ttdeci">size_t datasize_</div><div class="ttdoc">Size of Image data in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00172">image.h:172</a></div></div>
<div class="ttc" id="labeling__bolelli__2019__forest__firstline_8inc_html"><div class="ttname"><a href="labeling__bolelli__2019__forest__firstline_8inc.html">labeling_bolelli_2019_forest_firstline.inc</a></div></div>
<div class="ttc" id="namespaceecvl_html_a3bf5dfcb46547e44a33b6909ff900fef"><div class="ttname"><a href="namespaceecvl.html#a3bf5dfcb46547e44a33b6909ff900fef">ecvl::vsize</a></div><div class="ttdeci">int vsize(const std::vector&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00034">image.h:34</a></div></div>
<div class="ttc" id="namespaceecvl_html_aed7ae9e9c78f257354b6c638521cc1ab"><div class="ttname"><a href="namespaceecvl.html#aed7ae9e9c78f257354b6c638521cc1ab">ecvl::ConnectedComponentsLabeling</a></div><div class="ttdeci">void ConnectedComponentsLabeling(const Image &amp;src, Image &amp;dst)</div><div class="ttdoc">Labels connected components in an binary Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00335">imgproc.cpp:335</a></div></div>
<div class="ttc" id="namespaceecvl_html_a8e3c4feba7fabfb06ed2d617e1640f79"><div class="ttname"><a href="namespaceecvl.html#a8e3c4feba7fabfb06ed2d617e1640f79">ecvl::VConcat</a></div><div class="ttdeci">void VConcat(const std::vector&lt; Image &gt; &amp;src, Image &amp;dst)</div><div class="ttdoc">Vertical concatenation of images (with the same number of columns)</div></div>
<div class="ttc" id="namespaceecvl_html_abfd80fb03b661615f126a640c47e36c4"><div class="ttname"><a href="namespaceecvl.html#abfd80fb03b661615f126a640c47e36c4">ecvl::FindContours</a></div><div class="ttdeci">void FindContours(const Image &amp;src, std::vector&lt; std::vector&lt; Point2i &gt;&gt; &amp;contours)</div><div class="ttdoc">Finds contours in a binary image.</div></div>
<div class="ttc" id="labeling__bolelli__2019__forest_8inc_html"><div class="ttname"><a href="labeling__bolelli__2019__forest_8inc.html">labeling_bolelli_2019_forest.inc</a></div></div>
<div class="ttc" id="namespaceecvl_html_aaf30aceb57f44dc62f5f666f3955d857"><div class="ttname"><a href="namespaceecvl.html#aaf30aceb57f44dc62f5f666f3955d857">ecvl::DataType</a></div><div class="ttdeci">DataType</div><div class="ttdoc">DataType is an enum class which defines data types allowed for images.</div><div class="ttdef"><b>Definition:</b> <a href="datatype_8h_source.html#l00038">datatype.h:38</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a78886ac222536f1d6e8e83d868482b5a"><div class="ttname"><a href="classecvl_1_1_image.html#a78886ac222536f1d6e8e83d868482b5a">ecvl::Image::elemtype_</a></div><div class="ttdeci">DataType elemtype_</div><div class="ttdoc">Type of Image pixels, must be one of the values available in DataType.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00120">image.h:120</a></div></div>
<div class="ttc" id="namespaceecvl_html_a0bc0e1d73dcaf4593255a0c9d9325cb3"><div class="ttname"><a href="namespaceecvl.html#a0bc0e1d73dcaf4593255a0c9d9325cb3">ecvl::ColorType</a></div><div class="ttdeci">ColorType</div><div class="ttdoc">Enum class representing the ECVL supported color spaces.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00050">image.h:50</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a48a690afebe942f779dd1520c61d4d9e"><div class="ttname"><a href="classecvl_1_1_image.html#a48a690afebe942f779dd1520c61d4d9e">ecvl::Image::colortype_</a></div><div class="ttdeci">ColorType colortype_</div><div class="ttdoc">Image ColorType.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00153">image.h:153</a></div></div>
<div class="ttc" id="classecvl_1_1_const_contiguous_view_x_y_c_html_ab470b8de72bdc6126660f0ce18d90c08"><div class="ttname"><a href="classecvl_1_1_const_contiguous_view_x_y_c.html#ab470b8de72bdc6126660f0ce18d90c08">ecvl::ConstContiguousViewXYC::height</a></div><div class="ttdeci">int height() const</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00821">image.h:821</a></div></div>
<div class="ttc" id="namespaceecvl_html_ac69b90ce1163b068f47b77b19ae0d54c"><div class="ttname"><a href="namespaceecvl.html#ac69b90ce1163b068f47b77b19ae0d54c">ecvl::InterpolationType</a></div><div class="ttdeci">InterpolationType</div><div class="ttdoc">Enum class representing the ECVL interpolation types.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8h_source.html#l00037">imgproc.h:37</a></div></div>
<div class="ttc" id="namespaceecvl_html_a5f6d520e7726efcb41a38a9ffd0f4a97"><div class="ttname"><a href="namespaceecvl.html#a5f6d520e7726efcb41a38a9ffd0f4a97">ecvl::AdditiveLaplaceNoise</a></div><div class="ttdeci">void AdditiveLaplaceNoise(const Image &amp;src, Image &amp;dst, double std_dev)</div><div class="ttdoc">Adds Laplace distributed noise to an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00248">imgproc.cpp:248</a></div></div>
<div class="ttc" id="namespaceecvl_html_ab71c66befd58dc3a45874b771021893f"><div class="ttname"><a href="namespaceecvl.html#ab71c66befd58dc3a45874b771021893f">ecvl::Add</a></div><div class="ttdeci">void Add(const Image &amp;src1, const Image &amp;src2, Image &amp;dst, DataType dst_type=DataType::none, bool saturate=true)</div><div class="ttdoc">Adds two source Images storing the result into a destination Image.</div><div class="ttdef"><b>Definition:</b> <a href="arithmetic_8h_source.html#l00069">arithmetic.h:69</a></div></div>
<div class="ttc" id="namespaceecvl_html_a41dc0a70968cd6341a85615737ba87a1"><div class="ttname"><a href="namespaceecvl.html#a41dc0a70968cd6341a85615737ba87a1">ecvl::Threshold</a></div><div class="ttdeci">void Threshold(const Image &amp;src, Image &amp;dst, double thresh, double maxval, ThresholdingType thresh_type=ThresholdingType::BINARY)</div><div class="ttdoc">Applies a fixed threshold to an input Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00120">imgproc.cpp:120</a></div></div>
<div class="ttc" id="namespaceecvl_html_a1222d5cc5852781f9cbe9ef651854f96"><div class="ttname"><a href="namespaceecvl.html#a1222d5cc5852781f9cbe9ef651854f96">ecvl::Histogram</a></div><div class="ttdeci">std::vector&lt; double &gt; Histogram(const Image &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00127">imgproc.cpp:127</a></div></div>
<div class="ttc" id="namespaceecvl_html_a1ef076d9934ba5b0228f477d60fdb64c"><div class="ttname"><a href="namespaceecvl.html#a1ef076d9934ba5b0228f477d60fdb64c">ecvl::HConcat</a></div><div class="ttdeci">void HConcat(const std::vector&lt; Image &gt; &amp;src, Image &amp;dst)</div><div class="ttdoc">Horizontal concatenation of images (with the same number of rows)</div></div>
<div class="ttc" id="namespaceecvl_html_aeb20ecb4f245bbd530c845e96d4b5c59"><div class="ttname"><a href="namespaceecvl.html#aeb20ecb4f245bbd530c845e96d4b5c59">ecvl::Transpose</a></div><div class="ttdeci">void Transpose(const Image &amp;src, Image &amp;dst)</div><div class="ttdoc">Swap rows and columns of an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00476">imgproc.cpp:476</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a57e71471d03572edf43110db00a7d21d"><div class="ttname"><a href="classecvl_1_1_image.html#a57e71471d03572edf43110db00a7d21d">ecvl::Image::Height</a></div><div class="ttdeci">int Height() const</div><div class="ttdoc">Returns the height of Image.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00485">image.h:485</a></div></div>
<div class="ttc" id="namespaceecvl_html_a94d1bc1bcbe04e147ab0c95c3cfaa92ea98ad0e8750ae10ad556ed7a62affb452"><div class="ttname"><a href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92ea98ad0e8750ae10ad556ed7a62affb452">ecvl::ThresholdingType::BINARY</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a6a74e60fe9da7dd77117b50122d492cb"><div class="ttname"><a href="classecvl_1_1_image.html#a6a74e60fe9da7dd77117b50122d492cb">ecvl::Image::strides_</a></div><div class="ttdeci">std::vector&lt; int &gt; strides_</div><div class="ttdoc">Vector of Image strides.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00125">image.h:125</a></div></div>
<div class="ttc" id="namespaceecvl_html_ae40603a556ee0f3dca6b1c32a9e4eae9"><div class="ttname"><a href="namespaceecvl.html#ae40603a556ee0f3dca6b1c32a9e4eae9">ecvl::OtsuThreshold</a></div><div class="ttdeci">int OtsuThreshold(const Image &amp;src)</div><div class="ttdoc">Calculates the Otsu thresholding value.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00139">imgproc.cpp:139</a></div></div>
<div class="ttc" id="structecvl_1_1_u_f_p_c_html_ae002dee3fc4d6551797b1d454eaa6d1e"><div class="ttname"><a href="structecvl_1_1_u_f_p_c.html#ae002dee3fc4d6551797b1d454eaa6d1e">ecvl::UFPC::P_</a></div><div class="ttdeci">unsigned * P_</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00826">cpu_hal_imgproc.cpp:826</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_ac666790c7b5bcdb955c7d32938b1f0f9"><div class="ttname"><a href="classecvl_1_1_image.html#ac666790c7b5bcdb955c7d32938b1f0f9">ecvl::Image::Ptr</a></div><div class="ttdeci">uint8_t * Ptr(const std::vector&lt; int &gt; &amp;coords)</div><div class="ttdoc">Returns a non-const pointer to data at given coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00494">image.h:494</a></div></div>
<div class="ttc" id="namespaceecvl_html_ad1c7691a1077870fe935da837a3759f6"><div class="ttname"><a href="namespaceecvl.html#ad1c7691a1077870fe935da837a3759f6">ecvl::ResizeScale</a></div><div class="ttdeci">void ResizeScale(const ecvl::Image &amp;src, ecvl::Image &amp;dst, const std::vector&lt; double &gt; &amp;scales, InterpolationType interp=InterpolationType::linear)</div><div class="ttdoc">Resizes an Image by scaling the dimensions to a given scale factor.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00058">imgproc.cpp:58</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a45a4b6379cc953438867ec2753a65648"><div class="ttname"><a href="classecvl_1_1_image.html#a45a4b6379cc953438867ec2753a65648">ecvl::Image::elemsize_</a></div><div class="ttdeci">uint8_t elemsize_</div><div class="ttdoc">Size (in bytes) of Image pixels.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00122">image.h:122</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a1780d0fc6a41ed47a76d2789ca2b0841"><div class="ttname"><a href="classecvl_1_1_image.html#a1780d0fc6a41ed47a76d2789ca2b0841">ecvl::Image::ContiguousBegin</a></div><div class="ttdeci">ContiguousIterator&lt; T &gt; ContiguousBegin()</div><div class="ttdoc">Contiguous non-const Begin Iterator.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00230">image.h:230</a></div></div>
<div class="ttc" id="structecvl_1_1_u_f_p_c_html_aa0664e3a00e0c760aba5600f321aeab8"><div class="ttname"><a href="structecvl_1_1_u_f_p_c.html#aa0664e3a00e0c760aba5600f321aeab8">ecvl::UFPC::Merge</a></div><div class="ttdeci">unsigned Merge(unsigned i, unsigned j)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00835">cpu_hal_imgproc.cpp:835</a></div></div>
<div class="ttc" id="namespaceecvl_html_a0f9583965531c991ddc9e1375ba3be93"><div class="ttname"><a href="namespaceecvl.html#a0f9583965531c991ddc9e1375ba3be93">ecvl::GetOpenCVInterpolation</a></div><div class="ttdeci">int GetOpenCVInterpolation(InterpolationType interp)</div><div class="ttdoc">Given an InterpolationType, the GetOpenCVInterpolation function returns the associated OpenCV enum va...</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00033">imgproc.cpp:33</a></div></div>
<div class="ttc" id="namespaceecvl_html_ae723594306a62266207448cf9277687a"><div class="ttname"><a href="namespaceecvl.html#ae723594306a62266207448cf9277687a">ecvl::GaussianBlur</a></div><div class="ttdeci">void GaussianBlur(const Image &amp;src, Image &amp;dst, int sizeX, int sizeY, double sigmaX, double sigmaY=0)</div><div class="ttdoc">Blurs an Image using a Gaussian kernel.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00195">imgproc.cpp:195</a></div></div>
<div class="ttc" id="namespaceecvl_html_a94d1bc1bcbe04e147ab0c95c3cfaa92e"><div class="ttname"><a href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92e">ecvl::ThresholdingType</a></div><div class="ttdeci">ThresholdingType</div><div class="ttdoc">Enum class representing the ECVL thresholding types.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8h_source.html#l00027">imgproc.h:27</a></div></div>
<div class="ttc" id="arithmetic_8h_html"><div class="ttname"><a href="arithmetic_8h.html">arithmetic.h</a></div></div>
<div class="ttc" id="namespaceecvl_html_abfe1f778b26877b429ce72d3bd387a2e"><div class="ttname"><a href="namespaceecvl.html#abfe1f778b26877b429ce72d3bd387a2e">ecvl::RotateFullImage2D</a></div><div class="ttdeci">void RotateFullImage2D(const ecvl::Image &amp;src, ecvl::Image &amp;dst, double angle, double scale=1.0, InterpolationType interp=InterpolationType::linear)</div><div class="ttdoc">Rotates an Image resizing the output accordingly.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00094">imgproc.cpp:94</a></div></div>
<div class="ttc" id="namespaceecvl_html_ad5dbd126a6cf39db0ae8fa2b013931d3"><div class="ttname"><a href="namespaceecvl.html#ad5dbd126a6cf39db0ae8fa2b013931d3">ecvl::BorderType</a></div><div class="ttdeci">BorderType</div><div class="ttdoc">Enum class representing the ECVL border types.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8h_source.html#l00331">imgproc.h:331</a></div></div>
<div class="ttc" id="namespaceecvl_html"><div class="ttname"><a href="namespaceecvl.html">ecvl</a></div><div class="ttdef"><b>Definition:</b> <a href="arithmetic_8h_source.html#l00024">arithmetic.h:24</a></div></div>
<div class="ttc" id="namespaceecvl_html_a19e7c44332430068d3aba9677a09446b"><div class="ttname"><a href="namespaceecvl.html#a19e7c44332430068d3aba9677a09446b">ecvl::SeparableFilter2D</a></div><div class="ttdeci">void SeparableFilter2D(const Image &amp;src, Image &amp;dst, const std::vector&lt; double &gt; &amp;kerX, const std::vector&lt; double &gt; &amp;kerY, DataType type=DataType::none)</div><div class="ttdoc">Convolves an Image with a couple of 1-dimensional kernels.</div></div>
<div class="ttc" id="classecvl_1_1_image_html_a709cf6785d9340859f9e8dba1f950f7a"><div class="ttname"><a href="classecvl_1_1_image.html#a709cf6785d9340859f9e8dba1f950f7a">ecvl::Image::contiguous_</a></div><div class="ttdeci">bool contiguous_</div><div class="ttdoc">Whether the image is stored contiguously or not in memory.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00173">image.h:173</a></div></div>
<div class="ttc" id="classecvl_1_1_const_contiguous_view_x_y_c_html"><div class="ttname"><a href="classecvl_1_1_const_contiguous_view_x_y_c.html">ecvl::ConstContiguousViewXYC</a></div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00794">image.h:794</a></div></div>
<div class="ttc" id="namespaceecvl_html_a00244523d7d67f01f86034f9358db690"><div class="ttname"><a href="namespaceecvl.html#a00244523d7d67f01f86034f9358db690">ecvl::GetMaxN</a></div><div class="ttdeci">std::vector&lt; ecvl::Point2i &gt; GetMaxN(const Image &amp;src, size_t n)</div><div class="ttdoc">Get the n maximum values that are in the source Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00322">imgproc.cpp:322</a></div></div>
<div class="ttc" id="namespaceecvl_html_a3300301af431df44980395b301ac4190"><div class="ttname"><a href="namespaceecvl.html#a3300301af431df44980395b301ac4190">ecvl::TypeInfo_t</a></div><div class="ttdeci">typename TypeInfo&lt; DT &gt;::basetype TypeInfo_t</div><div class="ttdef"><b>Definition:</b> <a href="datatype_8h_source.html#l00062">datatype.h:62</a></div></div>
<div class="ttc" id="namespaceecvl_html_a8316acc95f4f4127a702c643eff92b51"><div class="ttname"><a href="namespaceecvl.html#a8316acc95f4f4127a702c643eff92b51">ecvl::MatToImage</a></div><div class="ttdeci">ecvl::Image MatToImage(const cv::Mat &amp;m)</div><div class="ttdoc">Convert a cv::Mat into an ecvl::Image.</div><div class="ttdef"><b>Definition:</b> <a href="support__opencv_8cpp_source.html#l00021">support_opencv.cpp:21</a></div></div>
<div class="ttc" id="classecvl_1_1_contiguous_view_x_y_c_html_a0ad28b86332b6b381b9ac438dc11432f"><div class="ttname"><a href="classecvl_1_1_contiguous_view_x_y_c.html#a0ad28b86332b6b381b9ac438dc11432f">ecvl::ContiguousViewXYC::height</a></div><div class="ttdeci">int height() const</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00781">image.h:781</a></div></div>
<div class="ttc" id="standard__errors_8h_html_af98ae9eed5602ee7ec8cf11ebd970816"><div class="ttname"><a href="standard__errors_8h.html#af98ae9eed5602ee7ec8cf11ebd970816">ECVL_ERROR_NOT_REACHABLE_CODE</a></div><div class="ttdeci">#define ECVL_ERROR_NOT_REACHABLE_CODE</div><div class="ttdef"><b>Definition:</b> <a href="standard__errors_8h_source.html#l00024">standard_errors.h:24</a></div></div>
<div class="ttc" id="namespaceecvl_html_aeda12761dec92bd6362480d15c173487"><div class="ttname"><a href="namespaceecvl.html#aeda12761dec92bd6362480d15c173487">ecvl::AdditivePoissonNoise</a></div><div class="ttdeci">void AdditivePoissonNoise(const Image &amp;src, Image &amp;dst, double lambda)</div><div class="ttdoc">Adds Poisson distributed noise to an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00263">imgproc.cpp:263</a></div></div>
<div class="ttc" id="standard__errors_8h_html_aa415d0e113911df8a4beb5bb46ebf5ba"><div class="ttname"><a href="standard__errors_8h.html#aa415d0e113911df8a4beb5bb46ebf5ba">ECVL_ERROR_DIVISION_BY_ZERO</a></div><div class="ttdeci">#define ECVL_ERROR_DIVISION_BY_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="standard__errors_8h_source.html#l00031">standard_errors.h:31</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a07c762fff510ff3f7b3e267f72131ac3"><div class="ttname"><a href="classecvl_1_1_image.html#a07c762fff510ff3f7b3e267f72131ac3">ecvl::Image::Create</a></div><div class="ttdeci">void Create(const std::vector&lt; int &gt; &amp;dims, DataType elemtype, std::string channels, ColorType colortype, const std::vector&lt; float &gt; &amp;spacings=std::vector&lt; float &gt;(), Device dev=Device::CPU)</div><div class="ttdoc">Allocates new contiguous data if needed.</div><div class="ttdef"><b>Definition:</b> <a href="image_8cpp_source.html#l00021">image.cpp:21</a></div></div>
<div class="ttc" id="namespaceecvl_html_a8a3cab18a350386b58603f465537c379"><div class="ttname"><a href="namespaceecvl.html#a8a3cab18a350386b58603f465537c379">ecvl::Rotate2D</a></div><div class="ttdeci">void Rotate2D(const ecvl::Image &amp;src, ecvl::Image &amp;dst, double angle, const std::vector&lt; double &gt; &amp;center={}, double scale=1.0, InterpolationType interp=InterpolationType::linear)</div><div class="ttdoc">Rotates an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00083">imgproc.cpp:83</a></div></div>
<div class="ttc" id="classecvl_1_1_const_view_html"><div class="ttname"><a href="classecvl_1_1_const_view.html">ecvl::ConstView</a></div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00067">image.h:67</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_af26f5a4e644cef20597bd084bcddf1d0"><div class="ttname"><a href="classecvl_1_1_image.html#af26f5a4e644cef20597bd084bcddf1d0">ecvl::Image::dims_</a></div><div class="ttdeci">std::vector&lt; int &gt; dims_</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00123">image.h:123</a></div></div>
<div class="ttc" id="namespaceecvl_html_ac60a2f087e03fdac8ad7969eaf351616"><div class="ttname"><a href="namespaceecvl.html#ac60a2f087e03fdac8ad7969eaf351616">ecvl::Point2i</a></div><div class="ttdeci">std::array&lt; int, 2 &gt; Point2i</div><div class="ttdef"><b>Definition:</b> <a href="datatype_8h_source.html#l00023">datatype.h:23</a></div></div>
<div class="ttc" id="namespaceecvl_html_a409958191f9b8fd26b570fef59c7ef72"><div class="ttname"><a href="namespaceecvl.html#a409958191f9b8fd26b570fef59c7ef72">ecvl::Filter2D</a></div><div class="ttdeci">void Filter2D(const Image &amp;src, Image &amp;dst, const Image &amp;ker, DataType type=DataType::none)</div><div class="ttdoc">Convolves an Image with a kernel.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00156">imgproc.cpp:156</a></div></div>
<div class="ttc" id="namespaceecvl_html_ac4f0336afb75df754337fb55a106b12a"><div class="ttname"><a href="namespaceecvl.html#ac4f0336afb75df754337fb55a106b12a">ecvl::Stack</a></div><div class="ttdeci">void Stack(const std::vector&lt; Image &gt; &amp;src, Image &amp;dst)</div><div class="ttdoc">Stack a sequence of Images along a new depth dimension (images dimensions must match)</div></div>
<div class="ttc" id="namespaceecvl_html_a371534ebd422c20d6905bc0013bca16b"><div class="ttname"><a href="namespaceecvl.html#a371534ebd422c20d6905bc0013bca16b">ecvl::OpticalDistortion</a></div><div class="ttdeci">void OpticalDistortion(const Image &amp;src, Image &amp;dst, const std::array&lt; float, 2 &gt; &amp;distort_limit={ -0.3f, 0.3f }, const std::array&lt; float, 2 &gt; &amp;shift_limit={ -0.1f, 0.1f }, InterpolationType interp=InterpolationType::linear, BorderType border_type=BorderType::BORDER_REFLECT_101, const int &amp;border_value=0, const unsigned seed=std::default_random_engine::default_seed)</div><div class="ttdoc">Barrel / pincushion distortion. Based on https://github.com/albumentations-team/albumentations/blob/m...</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00497">imgproc.cpp:497</a></div></div>
<div class="ttc" id="labeling__bolelli__2019__forest__singleline_8inc_html"><div class="ttname"><a href="labeling__bolelli__2019__forest__singleline_8inc.html">labeling_bolelli_2019_forest_singleline.inc</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a1d589431ff9de24429b9595386a836dc"><div class="ttname"><a href="classecvl_1_1_image.html#a1d589431ff9de24429b9595386a836dc">ecvl::Image::Begin</a></div><div class="ttdeci">Iterator&lt; T &gt; Begin()</div><div class="ttdoc">Generic non-const Begin Iterator.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00196">image.h:196</a></div></div>
<div class="ttc" id="imgproc_8h_html"><div class="ttname"><a href="imgproc_8h.html">imgproc.h</a></div></div>
<div class="ttc" id="namespaceecvl_html_ab74faee8c2b550b7bee1fe07e0791c80"><div class="ttname"><a href="namespaceecvl.html#ab74faee8c2b550b7bee1fe07e0791c80">ecvl::NonMaximaSuppression</a></div><div class="ttdeci">void NonMaximaSuppression(const Image &amp;src, Image &amp;dst)</div><div class="ttdoc">Calculate the Non-Maxima suppression of the source Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00311">imgproc.cpp:311</a></div></div>
<div class="ttc" id="classecvl_1_1_contiguous_view_x_y_c_html"><div class="ttname"><a href="classecvl_1_1_contiguous_view_x_y_c.html">ecvl::ContiguousViewXYC</a></div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00754">image.h:754</a></div></div>
<div class="ttc" id="structecvl_1_1_u_f_p_c_html_a0233680ad101ec202165345f4d0c0e1a"><div class="ttname"><a href="structecvl_1_1_u_f_p_c.html#a0233680ad101ec202165345f4d0c0e1a">ecvl::UFPC::length_</a></div><div class="ttdeci">unsigned length_</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00827">cpu_hal_imgproc.cpp:827</a></div></div>
<div class="ttc" id="standard__errors_8h_html_a589272c0c7f190ea470e5563f0bf6574"><div class="ttname"><a href="standard__errors_8h.html#a589272c0c7f190ea470e5563f0bf6574">ECVL_ERROR_NOT_IMPLEMENTED</a></div><div class="ttdeci">#define ECVL_ERROR_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition:</b> <a href="standard__errors_8h_source.html#l00022">standard_errors.h:22</a></div></div>
<div class="ttc" id="namespaceecvl_html_a4696838ef2eb912185348d2585a3ce36"><div class="ttname"><a href="namespaceecvl.html#a4696838ef2eb912185348d2585a3ce36">ecvl::MorphType</a></div><div class="ttdeci">MorphType</div><div class="ttdoc">Enum class representing the ECVL morphology types.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8h_source.html#l00310">imgproc.h:310</a></div></div>
<div class="ttc" id="namespaceecvl_html_ac8a3ad3fc46ff27075d4b671cc996b6c"><div class="ttname"><a href="namespaceecvl.html#ac8a3ad3fc46ff27075d4b671cc996b6c">ecvl::GammaContrast</a></div><div class="ttdeci">void GammaContrast(const Image &amp;src, Image &amp;dst, double gamma)</div><div class="ttdoc">Adjust contrast by scaling each pixel value X to 255 * ((X/255) ** gamma).</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00278">imgproc.cpp:278</a></div></div>
<div class="ttc" id="namespaceecvl_html_abd1bed8d85c640bf76e16d28884b1715"><div class="ttname"><a href="namespaceecvl.html#abd1bed8d85c640bf76e16d28884b1715">ecvl::IntegralImage</a></div><div class="ttdeci">void IntegralImage(const Image &amp;src, Image &amp;dst, DataType dst_type=DataType::float64)</div><div class="ttdoc">Calculate the integral image of the source Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00300">imgproc.cpp:300</a></div></div>
<div class="ttc" id="namespaceecvl_html_a73979fb8877322e81048522db568a82d"><div class="ttname"><a href="namespaceecvl.html#a73979fb8877322e81048522db568a82d">ecvl::MeanStdDev</a></div><div class="ttdeci">void MeanStdDev(const Image &amp;src, std::vector&lt; double &gt; &amp;mean, std::vector&lt; double &gt; &amp;stddev)</div><div class="ttdoc">Calculates the mean and the standard deviation of an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00467">imgproc.cpp:467</a></div></div>
<div class="ttc" id="namespaceecvl_html_ad058d736c33b57b2ac70e690ba642739"><div class="ttname"><a href="namespaceecvl.html#ad058d736c33b57b2ac70e690ba642739">ecvl::RGB2GRAYGeneric</a></div><div class="ttdeci">void RGB2GRAYGeneric(const uint8_t *r, const uint8_t *g, const uint8_t *b, uint8_t *dst, DataType dt)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00028">cpu_hal_imgproc.cpp:28</a></div></div>
<div class="ttc" id="classecvl_1_1_contiguous_view_x_y_c_html_a25ade471367003bedb8cf4507069815f"><div class="ttname"><a href="classecvl_1_1_contiguous_view_x_y_c.html#a25ade471367003bedb8cf4507069815f">ecvl::ContiguousViewXYC::width</a></div><div class="ttdeci">int width() const</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00780">image.h:780</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_ac2832f7a816690be3358eac0680f50a3"><div class="ttname"><a href="classecvl_1_1_image.html#ac2832f7a816690be3358eac0680f50a3">ecvl::Image::dev_</a></div><div class="ttdeci">Device dev_</div><div class="ttdoc">Identifier for the device on which the image data is.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00184">image.h:184</a></div></div>
<div class="ttc" id="namespaceecvl_html_a1acfb7be8dd74703ac91f916339c464b"><div class="ttname"><a href="namespaceecvl.html#a1acfb7be8dd74703ac91f916339c464b">ecvl::ImageToMat</a></div><div class="ttdeci">cv::Mat ImageToMat(const Image &amp;img)</div><div class="ttdoc">Convert an ECVL Image into OpenCV Mat.</div><div class="ttdef"><b>Definition:</b> <a href="support__opencv_8cpp_source.html#l00106">support_opencv.cpp:106</a></div></div>
<div class="ttc" id="namespaceecvl_html_a9ec879df867dfb4bb963210b1965e492"><div class="ttname"><a href="namespaceecvl.html#a9ec879df867dfb4bb963210b1965e492">ecvl::OpenCVAlwaysCheck</a></div><div class="ttdeci">void OpenCVAlwaysCheck(const ecvl::Image &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00047">cpu_hal_imgproc.cpp:47</a></div></div>
<div class="ttc" id="namespaceecvl_html_a518c444d5c0b3697fc248ef964094f51"><div class="ttname"><a href="namespaceecvl.html#a518c444d5c0b3697fc248ef964094f51">ecvl::Flip2D</a></div><div class="ttdeci">void Flip2D(const ecvl::Image &amp;src, ecvl::Image &amp;dst)</div><div class="ttdoc">Flips an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00069">imgproc.cpp:69</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a7b6db514661e150f16a534abe577c859"><div class="ttname"><a href="classecvl_1_1_image.html#a7b6db514661e150f16a534abe577c859">ecvl::Image::Channels</a></div><div class="ttdeci">int Channels() const</div><div class="ttdoc">Returns the number of channels.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00461">image.h:461</a></div></div>
<div class="ttc" id="classecvl_1_1_const_view_html_a931150d6555286759de15cff396d2fad"><div class="ttname"><a href="classecvl_1_1_const_view.html#a931150d6555286759de15cff396d2fad">ecvl::ConstView::End</a></div><div class="ttdeci">ConstIterator&lt; basetype &gt; End()</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00682">image.h:682</a></div></div>
<div class="ttc" id="support__opencv_8h_html"><div class="ttname"><a href="support__opencv_8h.html">support_opencv.h</a></div></div>
<div class="ttc" id="namespaceecvl_html_a94d1bc1bcbe04e147ab0c95c3cfaa92ea603de175b826a787a2d96b421089e16e"><div class="ttname"><a href="namespaceecvl.html#a94d1bc1bcbe04e147ab0c95c3cfaa92ea603de175b826a787a2d96b421089e16e">ecvl::ThresholdingType::BINARY_INV</a></div></div>
<div class="ttc" id="structecvl_1_1_u_f_p_c_html_a91ebc9166abd1f986e255401945f166f"><div class="ttname"><a href="structecvl_1_1_u_f_p_c.html#a91ebc9166abd1f986e255401945f166f">ecvl::UFPC::NewLabel</a></div><div class="ttdeci">unsigned NewLabel()</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00829">cpu_hal_imgproc.cpp:829</a></div></div>
<div class="ttc" id="namespaceecvl_html_ac0cadcb0a4b3bc15cb00dade7c004686"><div class="ttname"><a href="namespaceecvl.html#ac0cadcb0a4b3bc15cb00dade7c004686">ecvl::ElasticTransform</a></div><div class="ttdeci">void ElasticTransform(const Image &amp;src, Image &amp;dst, double alpha=34., double sigma=4., InterpolationType interp=InterpolationType::linear, BorderType border_type=BorderType::BORDER_REFLECT_101, const int &amp;border_value=0, const unsigned seed=std::default_random_engine::default_seed)</div><div class="ttdoc">Elastic deformation of input Image. Based on https://github.com/albumentations-team/albumentations/bl...</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00490">imgproc.cpp:490</a></div></div>
<div class="ttc" id="namespaceecvl_html_a616ea6f429139cd593198b7804a2a5fd"><div class="ttname"><a href="namespaceecvl.html#a616ea6f429139cd593198b7804a2a5fd">ecvl::Mirror2D</a></div><div class="ttdeci">void Mirror2D(const ecvl::Image &amp;src, ecvl::Image &amp;dst)</div><div class="ttdoc">Mirrors an Image.</div><div class="ttdef"><b>Definition:</b> <a href="imgproc_8cpp_source.html#l00076">imgproc.cpp:76</a></div></div>
<div class="ttc" id="classecvl_1_1_const_contiguous_view_x_y_c_html_a297480632d68860db6e01053eeba94d8"><div class="ttname"><a href="classecvl_1_1_const_contiguous_view_x_y_c.html#a297480632d68860db6e01053eeba94d8">ecvl::ConstContiguousViewXYC::width</a></div><div class="ttdeci">int width() const</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00820">image.h:820</a></div></div>
<div class="ttc" id="namespaceecvl_html_a43ed196d5b735918c287436a02f275cb"><div class="ttname"><a href="namespaceecvl.html#a43ed196d5b735918c287436a02f275cb">ecvl::FillCoordsVector</a></div><div class="ttdeci">void FillCoordsVector(vector&lt; float &gt; &amp;v, vector&lt; float &gt; &amp;steps, int size, int num_steps)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l01482">cpu_hal_imgproc.cpp:1482</a></div></div>
<div class="ttc" id="datatype__existing__tuples_8inc_8h_html"><div class="ttname"><a href="datatype__existing__tuples_8inc_8h.html">datatype_existing_tuples.inc.h</a></div></div>
<div class="ttc" id="namespaceecvl_html_a21b3629467ff82c5e3240e353beaad04"><div class="ttname"><a href="namespaceecvl.html#a21b3629467ff82c5e3240e353beaad04">ecvl::ThresholdImpl</a></div><div class="ttdeci">void ThresholdImpl(const Image &amp;src, Image &amp;dst, double thresh, double maxval, ThresholdingType thresh_type)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__hal__imgproc_8cpp_source.html#l00369">cpu_hal_imgproc.cpp:369</a></div></div>
<div class="ttc" id="classecvl_1_1_const_view_html_a03e918dcbad84ebed57b54e3fc0b54ee"><div class="ttname"><a href="classecvl_1_1_const_view.html#a03e918dcbad84ebed57b54e3fc0b54ee">ecvl::ConstView::Begin</a></div><div class="ttdeci">ConstIterator&lt; basetype &gt; Begin()</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00681">image.h:681</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_a3f51763dfef4581639a1c9691e072e05"><div class="ttname"><a href="classecvl_1_1_image.html#a3f51763dfef4581639a1c9691e072e05">ecvl::Image::End</a></div><div class="ttdeci">Iterator&lt; T &gt; End()</div><div class="ttdoc">Generic non-const End Iterator.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00204">image.h:204</a></div></div>
<div class="ttc" id="classecvl_1_1_image_html_ac08c58802200db31fb2167c5ade4367d"><div class="ttname"><a href="classecvl_1_1_image.html#ac08c58802200db31fb2167c5ade4367d">ecvl::Image::spacings_</a></div><div class="ttdeci">std::vector&lt; float &gt; spacings_</div><div class="ttdoc">Space between pixels/voxels.</div><div class="ttdef"><b>Definition:</b> <a href="image_8h_source.html#l00160">image.h:160</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
